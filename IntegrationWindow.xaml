<Window x:Class="IMS.IntegrationWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IMS"
        mc:Ignorable="d"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FontFamily="Segoe UI">
  <Window.Resources>
    <!-- Custom Title Bar Buttons Style -->
    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="30"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Style for Toolbar Buttons (Base for Path Icons) -->
    <!-- Style for Main Menu Items -->
    <Style TargetType="{x:Type MenuItem}">
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Padding" Value="7,5"/>
      <Setter Property="Background" Value="White"/>
    </Style>

    <Style TargetType="{x:Type Menu}">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
    </Style>

    <!-- Drop shadow effect for dropdowns/tooltips -->
    <DropShadowEffect x:Key="MaterialDesignShadowDepth1"
                           BlurRadius="8" Direction="270" ShadowDepth="2" Opacity="0.12" Color="#000000"/>

    <!-- Control Template for TreeViewItem to customize its appearance -->
    <ControlTemplate x:Key="CustomTreeViewItemTemplate" TargetType="{x:Type TreeViewItem}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Expander Button (the little arrow) -->
        <ToggleButton x:Name="Expander"
                         IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                         ClickMode="Press"
                         Grid.Column="0" Grid.Row="0"
                         VerticalAlignment="Center" HorizontalAlignment="Left"
                         Focusable="False"
                         Width="18" Height="18" Margin="0,0,5,0">
          <ToggleButton.Template>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
              <Border Width="18" Height="18" CornerRadius="2" Background="Transparent" SnapsToDevicePixels="True">
                <Path x:Name="ExpandPath"
                                 Data="M 0 0 L 4 4 L 0 8 Z"
                                 Stroke="#333333" StrokeThickness="1" Fill="Transparent"
                                 HorizontalAlignment="Center" VerticalAlignment="Center">
                  <Path.LayoutTransform>
                    <RotateTransform Angle="0"/>
                  </Path.LayoutTransform>
                </Path>
              </Border>
              <ControlTemplate.Triggers>
                <Trigger Property="IsChecked" Value="True">
                  <Setter TargetName="ExpandPath" Property="LayoutTransform">
                    <Setter.Value>
                      <RotateTransform Angle="90"/>
                    </Setter.Value>
                  </Setter>
                  <Setter TargetName="ExpandPath" Property="Data" Value="M 0 0 L 8 0 L 4 4 Z"/>
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </ToggleButton.Template>
        </ToggleButton>

        <!-- Header Content Container -->
        <Border x:Name="HeaderBorder"
                   Grid.Column="1" Grid.Row="0"
                   Padding="5,7" Margin="0,1,0,1"
                   CornerRadius="3"
                   BorderThickness="1" BorderBrush="Transparent"
                   Background="Transparent"
                   SnapsToDevicePixels="True">
          <ContentPresenter x:Name="PART_Header"
                                 ContentSource="Header"
                                 HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
        </Border>

        <!-- Children Items Panel -->
        <ItemsPresenter x:Name="ItemsHost"
                           Grid.Column="1" Grid.Row="1"
                           Margin="15,0,0,0" Visibility="Collapsed"/>
      </Grid>

      <ControlTemplate.Triggers>
        <!-- Show/Hide Children -->
        <Trigger Property="IsExpanded" Value="True">
          <Setter TargetName="ItemsHost" Property="Visibility" Value="Visible"/>
        </Trigger>

        <!-- Hide Expander if no children (HasItems) -->
        <Trigger Property="HasItems" Value="False">
          <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
        </Trigger>

        <!-- Hover State -->
        <Trigger Property="IsMouseOver" Value="True">
          <Setter TargetName="HeaderBorder" Property="Background" Value="#F0F0F0"/>
          <Setter TargetName="HeaderBorder" Property="BorderBrush" Value="Transparent"/>
        </Trigger>

        <!-- Selected State -->
        <Trigger Property="IsSelected" Value="True">
          <Setter TargetName="HeaderBorder" Property="Background" Value="#E6F2F7"/>
          <Setter TargetName="HeaderBorder" Property="BorderBrush" Value="#007ACC"/>
        </Trigger>
      </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Custom TreeViewItem Style for folder/cabinet icons using Segoe MDL2 Assets -->
    <Style x:Key="CabinetTreeViewItemStyle" TargetType="TreeViewItem">
      <Setter Property="Template" Value="{StaticResource CustomTreeViewItemTemplate}"/>

      <Setter Property="HeaderTemplate">
        <Setter.Value>
          <DataTemplate>
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
              <!-- Icon TextBlock for TreeViewItem -->
              <TextBlock Text="&#xF12B;"
                        FontFamily="Segoe MDL2 Assets"
                        FontSize="22"
                        Margin="0,0,8,0"
                        VerticalAlignment="Center">
                <TextBlock.Style>
                  <Style TargetType="TextBlock">
                    <Setter Property="Foreground" Value="#3498DB"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type TreeViewItem}}, Path=IsSelected}" Value="True">
                        <Setter Property="Foreground" Value="#3498DB"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </TextBlock.Style>
              </TextBlock>

              <!-- Header TextBlock for TreeViewItem -->
              <TextBlock Text="{Binding}"
                        VerticalAlignment="Center"
                        FontSize="16">
                <TextBlock.Style>
                  <Style TargetType="TextBlock">
                    <Setter Property="Foreground" Value="#333333"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type TreeViewItem}}, Path=IsSelected}" Value="True">
                        <Setter Property="Foreground" Value="#333333"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </TextBlock.Style>
              </TextBlock>
            </StackPanel>
          </DataTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="Padding" Value="0"/>
      <Setter Property="Margin" Value="0"/>
      <Setter Property="Background" Value="Transparent"/>
    </Style>

    <!-- NEW: Style for ListBoxItem to include document icon and handle selection -->
    <Style x:Key="ScannedDocumentListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Margin" Value="0,0,0,5"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd"
                   Background="{TemplateBinding Background}"
                   BorderBrush="{TemplateBinding BorderBrush}"
                   BorderThickness="{TemplateBinding BorderThickness}"
                   Padding="{TemplateBinding Padding}"
                   SnapsToDevicePixels="true">
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <!-- Document Icon - Changed to &#xE8F1; -->
                <TextBlock Text="&#xE8F1;"
                          FontFamily="Segoe MDL2 Assets"
                          FontSize="22"
                          Margin="0,0,8,0"
                          VerticalAlignment="Center">
                  <TextBlock.Style>
                    <Style TargetType="TextBlock">
                      <Setter Property="Foreground" Value="#3498DB"/>
                      <Style.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" Value="True">
                          <Setter Property="Foreground" Value="#3498DB"/>
                        </DataTrigger>
                      </Style.Triggers>
                    </Style>
                  </TextBlock.Style>
                </TextBlock>
                <!-- Content Presenter for the ListBoxItem's text -->
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                 SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
              </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#E6F2F7"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC"/>
                <Setter TargetName="Bd" Property="BorderThickness" Value="1"/>
              </Trigger>
              <MultiTrigger>
                <MultiTrigger.Conditions>
                  <Condition Property="IsSelected" Value="True"/>
                  <Condition Property="Selector.IsSelectionActive" Value="False"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#DDDDDD"/>
              </MultiTrigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Foreground" Value="#333333"/>
    </Style>

    <ControlTemplate x:Key="VerticalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
      <Grid x:Name="GridRoot" Width="{TemplateBinding Width}" Background="{TemplateBinding Background}">
        <Grid.RowDefinitions>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Track x:Name="PART_Track" Grid.Row="0"
                IsDirectionReversed="true"
                Focusable="false">
          <Track.Thumb>
            <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Width="{TemplateBinding Width}">
              <Thumb.Template>
                <ControlTemplate TargetType="{x:Type Thumb}">
                  <Border Background="{TemplateBinding Background}"
       BorderBrush="{TemplateBinding BorderBrush}"
       CornerRadius="5"
       Margin="1,0,1,0"/>
                </ControlTemplate>
              </Thumb.Template>
            </Thumb>
          </Track.Thumb>
        </Track>
      </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="HorizontalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
      <Grid x:Name="GridRoot" Height="{TemplateBinding Height}" Background="{TemplateBinding Background}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Track x:Name="PART_Track" Grid.Column="0"
               IsDirectionReversed="false"
               Focusable="false">
          <Track.Thumb>
            <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Height="{TemplateBinding Height}">
              <Thumb.Template>
                <ControlTemplate TargetType="{x:Type Thumb}">
                  <Border Background="{TemplateBinding Background}"
       BorderBrush="{TemplateBinding BorderBrush}"
       CornerRadius="5"
       Margin="0,1,0,1"/>
                </ControlTemplate>
              </Thumb.Template>
              <!-- Corrected closing tag here -->
            </Thumb>
          </Track.Thumb>
        </Track>
      </Grid>
    </ControlTemplate>

    <!-- Implicit Style for ScrollBar, applying templates based on Orientation -->
    <Style TargetType="{x:Type ScrollBar}">
      <Setter Property="Background" Value="Transparent"/>
      <Style.Triggers>
        <Trigger Property="Orientation" Value="Vertical">
          <Setter Property="Template" Value="{StaticResource VerticalScrollBarTemplate}"/>
          <Setter Property="Width" Value="10"/>
          <Setter Property="Margin" Value="0,1,0,1"/>
        </Trigger>
        <Trigger Property="Orientation" Value="Horizontal">
          <Setter Property="Template" Value="{StaticResource HorizontalScrollBarTemplate}"/>
          <Setter Property="Height" Value="10"/>
          <Setter Property="Margin" Value="1,0,1,0"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <!-- Corrected FocusedBorderStyle to use Auto for scrollbar visibility -->
    <Style x:Key="FocusedBorderStyle" TargetType="{x:Type TextBox}">
      <Setter Property="Padding" Value="0,10,0,10" />
      <Setter Property="FontSize" Value="16" />
      <Setter Property="Foreground" Value="#333" />
      <Setter Property="VerticalContentAlignment" Value="Top" />
      <Setter Property="CaretBrush" Value="#333" />
      <!-- Added CaretBrush for consistency -->
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type TextBox}">
            <Border x:Name="OuterBorder"
                    BorderBrush="#CCC"
                    BorderThickness="1"
                    CornerRadius="0"
                    Padding="6.6,0,6.6,0"
                    Background="{TemplateBinding Background}">
              <ScrollViewer x:Name="PART_ContentHost" Focusable="False"
                            HorizontalScrollBarVisibility="Auto"
                            VerticalScrollBarVisibility="Auto" />
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="OuterBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter TargetName="OuterBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ModernRadioButtonStyle" TargetType="{x:Type RadioButton}">
      <Setter Property="Foreground" Value="#333333" />
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Padding" Value="8,0,0,0" />
      <!-- Increased padding for text -->
      <Setter Property="VerticalContentAlignment" Value="Center" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type RadioButton}">
            <Grid Background="Transparent">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <!-- Custom RadioButton Outer Circle -->
              <Border x:Name="RadioButtonOuterCircle"
        Grid.Column="0"
        Width="18" Height="18"
        BorderBrush="#B0B0B0"
        BorderThickness="1.5"
        Background="White"
        CornerRadius="9"
        VerticalAlignment="Center"
        HorizontalAlignment="Left"
        Margin="0,0,5,0">
                <Border x:Name="RadioButtonInnerCircle"
        Width="9" Height="9"
        Background="#0078D7"
        CornerRadius="5"
        Visibility="Collapsed">
                  <Border.RenderTransform>
                    <ScaleTransform ScaleX="0" ScaleY="0" />
                  </Border.RenderTransform>
                </Border>
              </Border>
              <!-- Content Presenter for the RadioButton Text -->
              <ContentPresenter Grid.Column="1"
                                  Margin="{TemplateBinding Padding}"
                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                  SnapsToDevicePixels="True"
                                  RecognizesAccessKey="True" />
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="RadioButtonOuterCircle" Property="BorderBrush" Value="#0078D7" />
                <Setter TargetName="RadioButtonInnerCircle" Property="Visibility" Value="Visible" />
                <Trigger.EnterActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.ExitActions>
              </Trigger>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="RadioButtonOuterCircle" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ModernComboBoxSecondStyle" TargetType="ComboBox">
      <Setter Property="SnapsToDevicePixels" Value="True" />
      <Setter Property="OverridesDefaultStyle" Value="True" />
      <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
      <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
      <Setter Property="FontSize" Value="16" />
      <Setter Property="Background" Value="White" />
      <Setter Property="BorderBrush" Value="#CCC" />
      <Setter Property="Foreground" Value="#333" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ComboBox">
            <Grid>
              <!-- Border for main box -->
              <Border x:Name="Border"
          Background="{TemplateBinding Background}"
          BorderBrush="{TemplateBinding BorderBrush}"
          BorderThickness="1"
          CornerRadius="0"
          Padding="5"
          SnapsToDevicePixels="True" />
              <!-- Editable TextBox (will be visible when IsEditable=True) -->
              <TextBox x:Name="PART_EditableTextBox"
          Style="{x:Null}"
          Margin="8,0,25,0"
          VerticalAlignment="Center"
          HorizontalAlignment="Left"
          Focusable="True"
          Background="Transparent"
          BorderThickness="0"
          Visibility="Collapsed"
          IsReadOnly="{TemplateBinding IsReadOnly}" />
              <!-- ContentPresenter (will be visible when IsEditable=False) -->
              <ContentPresenter x:Name="PART_ContentPresenter"
          Margin="8,0,25,0"
          VerticalAlignment="Center"
          HorizontalAlignment="Left"
          Content="{TemplateBinding SelectionBoxItem}"
          ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
          ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
          RecognizesAccessKey="True"
          Visibility="Visible" />
              <!-- Initially visible -->
              <!-- Dropdown arrow button -->
              <ToggleButton x:Name="DropDownToggle"
          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
          Focusable="False"
          ClickMode="Press"
          Background="Transparent"
          BorderBrush="Transparent"
          HorizontalAlignment="Right"
          VerticalAlignment="Center"
          Width="30"
          Height="35" Padding="5,0,5,0"
          Margin="0,0,0,0">
                <Path Data="M 0 0 L 4 4 L 8 0 Z"
          Fill="#555"
          Width="14"
          Stretch="Uniform"
          HorizontalAlignment="Center"
          VerticalAlignment="Center" />
              </ToggleButton>
              <!-- Popup (the dropdown list) -->
              <Popup x:Name="Popup"
          Placement="Bottom"
          IsOpen="{TemplateBinding IsDropDownOpen}"
          AllowsTransparency="True"
          Focusable="False"
          PopupAnimation="Slide">
                <Grid MaxHeight="200"
          Width="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}"
          SnapsToDevicePixels="True">
                  <Border x:Name="DropDownBorder"
          Background="White"
          BorderBrush="#CCC"
          BorderThickness="1"
          CornerRadius="4"
          Margin="0,2,0,0" />
                  <ScrollViewer Margin="4,2,4,2"
          SnapsToDevicePixels="True">
                    <StackPanel IsItemsHost="True"
          KeyboardNavigation.DirectionalNavigation="Contained" />
                  </ScrollViewer>
                </Grid>
              </Popup>
            </Grid>
            <!-- States -->
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsFocused" Value="True">
                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
              <Trigger Property="HasItems" Value="False">
                <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
              </Trigger>
              <!-- Trigger for editable state -->
              <Trigger Property="IsEditable" Value="True">
                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible" />
                <Setter TargetName="PART_ContentPresenter" Property="Visibility" Value="Collapsed" />
                <Setter Property="IsTabStop" Value="False" />
                <Setter Property="KeyboardNavigation.IsTabStop" Value="False" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ModernCheckBoxStyle" TargetType="{x:Type CheckBox}">
      <Setter Property="Foreground" Value="red" />
      <Setter Property="FontSize" Value="18" />
      <Setter Property="Padding" Value="8,0,0,0" />
      <!-- Increased padding for text -->
      <Setter Property="VerticalContentAlignment" Value="Center" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type CheckBox}">
            <Grid Background="Transparent">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <!-- Custom CheckBox Square -->
              <Border x:Name="CheckBoxBorder"
          Grid.Column="0"
          Width="20" Height="20"
          BorderBrush="#B0B0B0"
          BorderThickness="1.5"
          Background="White"
          CornerRadius="4"
          VerticalAlignment="Center"
          HorizontalAlignment="Left"
          Margin="0,0,5,0">
                <Path x:Name="CheckMark"
          Width="10" Height="10"
          Stretch="Uniform"
          Fill="White"
          Data="M 0 5 L 3 8 L 8 0 L 0 5 Z"
          RenderTransformOrigin="0.5,0.5"
          Visibility="Collapsed">
                  <Path.RenderTransform>
                    <ScaleTransform ScaleX="0" ScaleY="0" />
                  </Path.RenderTransform>
                </Path>
              </Border>
              <!-- Content Presenter for the CheckBox Text -->
              <ContentPresenter Grid.Column="1"
          Margin="{TemplateBinding Padding}"
          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
          SnapsToDevicePixels="True"
          RecognizesAccessKey="True" />
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="CheckBoxBorder" Property="Background" Value="#0078D7" />
                <!-- Deeper blue -->
                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#0078D7" />
                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                <Trigger.EnterActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleX)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleY)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleX)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleY)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.ExitActions>
              </Trigger>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

  </Window.Resources>
  <Border Background="#F5F7FA" CornerRadius="0"
            BorderBrush="#FFE0E0E0" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#FFBBBBBB" Direction="270"
                              ShadowDepth="8" BlurRadius="25" Opacity="0.4"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="35"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>

      <!-- Title Bar -->
      <Border Grid.Row="0" Background="#FF333333"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown">
        <Grid>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <Image Source="/Images/logo.png" Width="20" Height="20" Margin="0,0,8,0"/>
            <TextBlock Text="Manage Connections" Margin="0,8,0,0"
                                   Foreground="White" FontSize="15" FontWeight="SemiBold"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE921;" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE922;" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeRestoreButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <!-- Main Menu -->
      <Menu Grid.Row="1" Padding="10,0,10,0">
        <MenuItem Header="Add Integration">
          <MenuItem Header="New Scan"/>
          <MenuItem Header="Batch Scan"/>
          <MenuItem Header="Import File"/>
          <MenuItem Header="Import Folder"/>
        </MenuItem>
        <MenuItem Header="Connection String">
          <MenuItem Header="Manage Batches"/>
          <MenuItem Header="Archive Batches"/>
        </MenuItem>
        <MenuItem Header="Copy Integration">
          <MenuItem Header="Create Document"/>
          <MenuItem Header="Merge Documents"/>
          <MenuItem Header="Split Document"/>
        </MenuItem>
        <MenuItem Header="Delete Integration">
          <MenuItem Header="Define Fields"/>
          <MenuItem Header="Populate Fields"/>
        </MenuItem>
        <MenuItem Header="Previous">
          <MenuItem Header="Apply Stamp"/>
          <MenuItem Header="Add Signature"/>
        </MenuItem>
        <MenuItem Header="Next">
          <MenuItem Header="Rotate"/>
          <MenuItem Header="Crop"/>
          <MenuItem Header="Brightness/Contrast"/>
          <MenuItem Header="Grayscale"/>
        </MenuItem>
        <MenuItem Header="Last">
          <MenuItem Header="Add Text"/>
          <MenuItem Header="Highlight"/>
          <MenuItem Header="Redact"/>
        </MenuItem>
        <MenuItem Header="Exit" Click="ExitMenuItem_Click"/>
      </Menu>

     

      <!-- Main Content Area - Split into four columns -->
      <Grid Grid.Row="2" Margin="10,10,10,10">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Column: Data Cabinet and Scanned Documents -->
        <Grid Grid.Column="0" Margin="0,0,10,0">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <Border Grid.Row="0"
                  Background="#FFFFFF" CornerRadius="5"
                  Effect="{StaticResource MaterialDesignShadowDepth1}" Margin="0,0,0,10">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="50"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <!-- Header for Integration ID -->
              <Border Grid.Row="0" Padding="10" Background="#F0F0F0">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>

                  <TextBlock Text="Integration ID"
                                Grid.Column="0"
                                Foreground="#333333"
                                FontSize="16"
                                FontWeight="SemiBold"
                                VerticalAlignment="Center"
                                Margin="0,0,10,0" />

                  <TextBox Style="{StaticResource FocusedBorderStyle}"
                           Grid.Column="1"
                           x:Name="IntegrationIDInput"
                    Height="27"
                           Padding="5,0,5,0"
                           VerticalContentAlignment="Center"
                           Text="" />
                </Grid>
              </Border>

              <!-- Scrollable TreeView -->
              <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="5">
                <TreeView BorderThickness="0" BorderBrush="Transparent">
                  <TreeViewItem Header="HR" Style="{StaticResource CabinetTreeViewItemStyle}">
                    <TreeViewItem Header="Personnel Files" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                    <TreeViewItem Header="Payroll" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                  </TreeViewItem>
                  <TreeViewItem Header="Safety" Style="{StaticResource CabinetTreeViewItemStyle}">
                    <TreeViewItem Header="Incident Reports" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                  </TreeViewItem>
                  <TreeViewItem Header="Test" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                  <TreeViewItem Header="Transport" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                  <TreeViewItem Header="allmove3" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                  <TreeViewItem Header="employeeinfo9" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                  <TreeViewItem Header="lateemployees" Style="{StaticResource CabinetTreeViewItemStyle}"/>
                </TreeView>
              </ScrollViewer>
            </Grid>
          </Border>
        </Grid>

        <!-- Right Column: Document Viewer / Work Area -->
        <Border Grid.Column="1" Background="#FFFFFF" CornerRadius="5" Effect="{StaticResource MaterialDesignShadowDepth1}" Margin="10,0,10,10">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="50"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Border Grid.Row="0"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Connection String To Source Database" VerticalAlignment="Center"
                        Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <StackPanel x:Name="DatabaseSource" Grid.Row="1" Margin="10">
              <Grid Margin="0,5,0,0">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <RadioButton Content="ACCESS" Style="{StaticResource ModernRadioButtonStyle}" Grid.Column="0"
                        IsChecked="True" GroupName="DatabaseSource_Group1" x:Name="AccessValueRadio" Margin="0,0,0,5" />
                <RadioButton Content="SQL" Style="{StaticResource ModernRadioButtonStyle}" Grid.Column="1"
                        GroupName="DatabaseSource_Group1" x:Name="SQLValueRadio" Margin="0,0,0,5" />
                <RadioButton Content="ORACLE" x:Name="ORACLEValueRadio" Style="{StaticResource ModernRadioButtonStyle}" Grid.Column="2"
                        GroupName="DatabaseSource_Group1" Margin="0,0,0,5" />
                <RadioButton Content="MYSQL" x:Name="MYSQLValueRadio" Style="{StaticResource ModernRadioButtonStyle}" Grid.Column="3"
                        GroupName="DatabaseSource_Group1" Margin="0,0,0,5" />
              </Grid>
            </StackPanel>
            <TextBox Grid.Row="2" Margin="10,0,10,10" Style="{StaticResource FocusedBorderStyle}" TextWrapping="Wrap"
                      AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Padding="0,10,0,10" />
            <Border Grid.Row="3"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="SQL Query To Source Database" VerticalAlignment="Center"
            Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <TextBox Grid.Row="4" Margin="10,10,10,10" Style="{StaticResource FocusedBorderStyle}" TextWrapping="Wrap"
                     AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Padding="0,10,0,10" />
            <Border Grid.Row="5"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Primary Key Of Source Database" VerticalAlignment="Center"
                         Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <TextBox Grid.Row="6" Margin="10,10,10,10" Style="{StaticResource FocusedBorderStyle}" TextWrapping="Wrap"
                     AcceptsReturn="True" VerticalScrollBarVisibility="Disabled" Padding="0,10,0,10" Height="45" />
            <Border Grid.Row="7"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Tabel Name of Source Database" VerticalAlignment="Center"
                         Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <TextBox Grid.Row="8" Margin="10,10,10,10" Style="{StaticResource FocusedBorderStyle}" TextWrapping="Wrap"
                     AcceptsReturn="True" VerticalScrollBarVisibility="Disabled" Padding="0,10,0,10" Height="45" />
            <Border Grid.Row="9"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Source Fields Type" VerticalAlignment="Center"
               Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <ComboBox Grid.Row="10" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
                      Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
            <Border Grid.Row="11"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Primary Key of Archive To Be Indexed" VerticalAlignment="Center"
    Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <ComboBox Grid.Row="12" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
           Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
              <ComboBoxItem Content="Stage 1: Document Upload" />
              <ComboBoxItem Content="Stage 2: Initial Review" />
              <ComboBoxItem Content="Stage 3: Approval Process" />
              <ComboBoxItem Content="Stage 4: Final Processing" />
              <ComboBoxItem Content="Stage 5: Archiving" />
            </ComboBox>
            <Border Grid.Row="13"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Additional Primary" VerticalAlignment="Center"
                          Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <TextBox Grid.Row="14" Margin="10,10,10,10" Style="{StaticResource FocusedBorderStyle}" TextWrapping="Wrap"
         AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Padding="0,10,0,10" />
          </Grid>
        </Border>

        <!-- Third Column: Fields To Be Synchronized -->
        <Border Grid.Column="2" Background="#FFFFFF" CornerRadius="5" Effect="{StaticResource MaterialDesignShadowDepth1}" Margin="10,0,10,10">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="50"/>
              <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Border Grid.Row="0"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="Fields To Be Synchronized" VerticalAlignment="Center"
                Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
            <Grid Grid.Row="1">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
              </Grid.RowDefinitions>
              <ComboBox Grid.Row="0" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
                        Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="1" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
                        Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="2" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
                        Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="3" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="4" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="5" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="6" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="7" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="8" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="9" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="10" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="11" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="12" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
              <ComboBox Grid.Row="13" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
          Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
                <ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />
              </ComboBox>
            </Grid>
          </Grid>
        </Border>

        <!-- Fourth Column: External Database -->
        <Border Grid.Column="3" Background="#FFFFFF" CornerRadius="5" Effect="{StaticResource MaterialDesignShadowDepth1}" Margin="10,0,10,10">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="50"/>
              <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Border Grid.Row="0"  Padding="10" Background="#F0F0F0">
              <TextBlock Text="External Database" VerticalAlignment="Center"
                Foreground="#333333" FontSize="16" FontWeight="SemiBold" />
            </Border>
              <Grid Grid.Row="1">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <ComboBox Grid.Row="0" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
              Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="1" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
              Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="2" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
              Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="3" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="4" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="5" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="6" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="7" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="8" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="9" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="10" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="11" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="12" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
    <ComboBox Grid.Row="13" Style="{StaticResource ModernComboBoxSecondStyle}" Height="35"
Margin="10,10,10,10" Text="" IsEditable="True" IsTextSearchEnabled="True">
      <ComboBoxItem Content="Stage 1: Document Upload" />
      <ComboBoxItem Content="Stage 2: Initial Review" />
      <ComboBoxItem Content="Stage 3: Approval Process" />
      <ComboBoxItem Content="Stage 4: Final Processing" />
      <ComboBoxItem Content="Stage 5: Archiving" />
    </ComboBox>
  </Grid>
            
          </Grid>
        </Border>
      </Grid>

      <!-- Toolbar -->
      <Border Grid.Row="3" Background="#fff" BorderBrush="Transparent" BorderThickness="0,0,0,1" Padding="10" Margin="0,0,0,20">
        <StackPanel Orientation="Horizontal" Margin="0,0,10,0" HorizontalAlignment="Right" VerticalAlignment="Center" >
          <!-- Changed Orientation to Horizontal -->
          <CheckBox Content="Workflow-Side Integration Only" Style="{StaticResource ModernCheckBoxStyle}"
          VerticalAlignment="Center" IsChecked="False" Margin="0,0,10,0"/>
          <!-- Added margin to separate from button -->

          <!-- Custom Button with Image and Text -->
          <Button BorderBrush="#6CBF45" Margin="20,0,0,0" 
        Background="#6CBF45"  Foreground="White" 
       Padding="15,8" FontWeight="SemiBold"
       FontSize="18">
            <StackPanel Orientation="Horizontal">
              <Image Source="/Images/saveimg.png" Width="22" Height="22" Margin="0,0,8,0"/>
              <TextBlock Text="Save" VerticalAlignment="Center"/>
            </StackPanel>
          </Button>

        </StackPanel>
      </Border>
    </Grid>
  </Border>
</Window>