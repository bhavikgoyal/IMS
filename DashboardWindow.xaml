<Window x:Class="IMS.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IMS"
        xmlns:fa="http://schemas.fontawesome.io/icons/"
        mc:Ignorable="d"
        Title="IMS Welcome Admin"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        PreviewKeyDown="Window_PreviewKeyDown">
 
  <Window.Resources>
    <!-- Custom Title Bar Buttons Style -->
    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="30"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Menu Style -->
    <Style TargetType="{x:Type Menu}">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="Padding" Value="5,0,0,0"/>
    </Style>

    <!-- Shadow Effect -->
    <DropShadowEffect x:Key="MaterialDesignShadowDepth2"
                      BlurRadius="14" Direction="270" ShadowDepth="4"
                      Opacity="0.26" Color="#000000"/>

    <!-- Top-Level MenuItem Style -->
    <Style x:Key="TopLevelMenuItemStyle" TargetType="{x:Type MenuItem}">
      <Setter Property="Padding" Value="15,10"/>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Foreground" Value="#666666"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type MenuItem}">
            <Border Name="Border" Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
              <Grid>
                <ContentPresenter ContentSource="Header"
                                  Margin="{TemplateBinding Padding}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Left"/>
                <Popup Name="PART_Popup" AllowsTransparency="True" Placement="Bottom"
                       IsOpen="{TemplateBinding IsSubmenuOpen}" Focusable="False"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                  <Border Background="White"
                          BorderBrush="#E0E0E0" BorderThickness="1"
                          CornerRadius="3"
                          Effect="{StaticResource MaterialDesignShadowDepth2}">
                    <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                  </Border>
                </Popup>
              </Grid>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsHighlighted" Value="True">
                <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
              </Trigger>
              <Trigger Property="IsSubmenuOpen" Value="True">
                <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="BoxMenuItemStyle" TargetType="{x:Type MenuItem}">
      <Setter Property="Padding" Value="15,10"/>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Foreground" Value="#666666"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type MenuItem}">
            <Border Name="Border" Background="{TemplateBinding Background}"
                    BorderBrush="Transparent"
                    BorderThickness="0">
              <Grid>
                <ContentPresenter ContentSource="Header"
                                  Margin="{TemplateBinding Padding}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Left"/>
                <Popup Name="PART_Popup" AllowsTransparency="True" Placement="Bottom"
                       IsOpen="{TemplateBinding IsSubmenuOpen}" Focusable="False"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                  <Border Background="White"
                          BorderBrush="#E0E0E0" BorderThickness="1"
                          CornerRadius="3"
                          Effect="{StaticResource MaterialDesignShadowDepth2}">
                    <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                  </Border>
                </Popup>
              </Grid>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsHighlighted" Value="True">
                <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
              </Trigger>
              <Trigger Property="IsSubmenuOpen" Value="True">
                <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>
    <Style x:Key="DropdownMenuItemStyle" TargetType="{x:Type MenuItem}">
      <Setter Property="Padding" Value="10,8"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type MenuItem}">
            <Border Name="Border" Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}">
              <Grid>
                <Grid.ColumnDefinitions>
                  <!-- Column 0 = Tick -->
                  <ColumnDefinition Width="25"/>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- ✔ CHECKMARK -->
                <Path x:Name="CheckMark"
                              Grid.Column="0"
                              VerticalAlignment="Center"
                              Stroke="#007ACC"
                              StrokeThickness="2"
                              Data="M 3 8 L 7 12 L 15 3"
                              Visibility="Collapsed"/>

                <!-- Header Text -->
                <ContentPresenter Grid.Column="1"
                                          ContentSource="Header"
                                          Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Left"/>

                <!-- Shortcut Text -->
                <TextBlock Text="{TemplateBinding InputGestureText}"
                                   Grid.Column="2"
                                   VerticalAlignment="Center"
                                   Margin="10,0,15,0"
                                   Foreground="#888888"/>

                <!-- Submenu Arrow -->
                <Path x:Name="RightArrow"
                              Grid.Column="3"
                              HorizontalAlignment="Right"
                              VerticalAlignment="Center"
                              Margin="5,0,5,0"
                              Data="M0,0 L4,4 L0,8 Z"
                              Fill="{TemplateBinding Foreground}"
                              Visibility="Collapsed"/>

                <!-- Submenu Popup -->
                <Popup Name="PART_Popup" AllowsTransparency="True"
                               Placement="Right"
                               IsOpen="{TemplateBinding IsSubmenuOpen}"
                               Focusable="False">
                  <Border Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="1"
                                    CornerRadius="3"
                                    Effect="{StaticResource MaterialDesignShadowDepth2}">
                    <StackPanel IsItemsHost="True"/>
                  </Border>
                </Popup>

              </Grid>
            </Border>

            <!-- TRIGGERS -->
            <ControlTemplate.Triggers>
              <!-- Hover Highlight -->
              <Trigger Property="IsHighlighted" Value="True">
                <Setter TargetName="Border"
                                Property="Background"
                                Value="#E8F0F7"/>
              </Trigger>

              <!-- SubMenu Arrow -->
              <Trigger Property="HasItems" Value="True">
                <Setter TargetName="RightArrow"
                                Property="Visibility"
                                Value="Visible"/>
              </Trigger>

              <!-- ✔ SHOW TICK WHEN CHECKED -->
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="CheckMark"
                                Property="Visibility"
                                Value="Visible"/>
                <Setter Property="Foreground" Value="#007ACC"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Background" Value="#EBF5FB"/>
              </Trigger>

            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!--<Style x:Key="DropdownMenuItemStyle" TargetType="{x:Type MenuItem}">
      <Setter Property="Padding" Value="10,8"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type MenuItem}">
            <Border Name="Border" Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
              <Grid>
                <Grid.ColumnDefinitions>
                  --><!-- Column 0 = Tick --><!--
                  <ColumnDefinition Width="25"/>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                --><!-- ✔ CHECKMARK --><!--
                <Path x:Name="CheckMark"
                              Grid.Column="0"
                              VerticalAlignment="Center"
                              Stroke="#007ACC"
                              StrokeThickness="2"
                              Data="M 3 8 L 7 12 L 15 3"
                              Visibility="Collapsed"/>

                --><!-- Header Text --><!--
                <ContentPresenter Grid.Column="1"
                                          ContentSource="Header"
                                          Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Left"/>
                

                <ContentPresenter ContentSource="Header"
                                  Margin="{TemplateBinding Padding}"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Left"/>
                <TextBlock Text="{TemplateBinding InputGestureText}"
                           Grid.Column="2" VerticalAlignment="Center"
                           Margin="10,0,15,0" Foreground="#888888"/>
                
                <Path x:Name="RightArrow" Grid.Column="3" HorizontalAlignment="Right"
                      VerticalAlignment="Center" Margin="5,0,5,0"
                      Data="M0,0 L4,4 L0,8 Z"
                      Fill="{TemplateBinding Foreground}" Visibility="Collapsed"/>

                <Popup Name="PART_Popup" AllowsTransparency="True" Placement="Right"
                       IsOpen="{TemplateBinding IsSubmenuOpen}" Focusable="False"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                  <Border Background="White"
                          BorderBrush="#E0E0E0" BorderThickness="1"
                          CornerRadius="3"
                          Effect="{StaticResource MaterialDesignShadowDepth2}">
                    <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                  </Border>
                </Popup>
              </Grid>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsHighlighted" Value="True">
                <Setter TargetName="Border" Property="Background" Value="#E8F0F7"/>
              </Trigger>
              <Trigger Property="HasItems" Value="True">
                <Setter TargetName="RightArrow" Property="Visibility" Value="Visible"/>
              </Trigger>
              <Trigger Property="IsChecked" Value="True">
                <Setter Property="Foreground" Value="#007ACC"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Background" Value="#EBF5FB"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>-->

    <Style TargetType="{x:Type ListBoxItem}">
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="border" Background="Transparent"
                    CornerRadius="8" Padding="10" Margin="0,5,0,5">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="border" Property="Background" Value="#E0E0E0"/>
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="border" Property="Background" Value="#D0D0D0"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Admin Dashboard Card Style -->
    <Style x:Key="AdminDashboardCardStyle" TargetType="{x:Type Border}">
      <Setter Property="Width" Value="350"/>
      <Setter Property="Background" Value="White"/>
      <Setter Property="CornerRadius" Value="8"/>
      <Setter Property="Padding" Value="20"/>
      <Setter Property="Margin" Value="0,0,0,0"/>
      <Setter Property="Effect">
        <Setter.Value>
          <DropShadowEffect BlurRadius="10" Direction="270" ShadowDepth="2" Opacity="0.15" Color="#000000"/>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Admin Dashboard Icon Style -->
    <Style x:Key="AdminIconStyle" TargetType="{x:Type fa:ImageAwesome}">
      <Setter Property="Width" Value="40"/>
      <Setter Property="Height" Value="40"/>
      <Setter Property="Foreground" Value="#007ACC"/>
      <Setter Property="Margin" Value="0,0,0,10"/>
    </Style>

    <Style x:Key="TransparentButtonStyle" TargetType="Button">
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <ContentPresenter/>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="0"/>
    </Style>

  </Window.Resources>

  <Border Background="#F0F0F0" CornerRadius="0"
          BorderBrush="#FFE0E0E0" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#FFBBBBBB" Direction="270"
                        ShadowDepth="8" BlurRadius="25" Opacity="0.4"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="35"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <Border Grid.Row="0" Background="#FF333333"
              MouseLeftButtonDown="Window_MouseLeftButtonDown">
        <Grid>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <Image Source="/Images/logo.png" Width="20" Height="20" Margin="0,0,8,0"/>
            <TextBlock Text="IMS Welcome ADMIN From HIJAZI_AND_GHOSHEH" Margin="0,8,0,0"
                       Foreground="White" FontSize="15" FontWeight="SemiBold"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE921;" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE922;" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeRestoreButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <!-- Menu -->
      <Menu Grid.Row="1" Background="White">
        <MenuItem x:Name="MenuGeneral" Header="General" Style="{StaticResource BoxMenuItemStyle}">
          <MenuItem Header="General Settings" Style="{StaticResource DropdownMenuItemStyle}" >
            <MenuItem x:Name="mnuLCI" Header="Load Combos Immediately" IsCheckable="True" IsChecked="True" Style="{StaticResource DropdownMenuItemStyle}" Click="mnuLoadCombo_Click"/>
            <MenuItem Header="Change Font Size" Style="{StaticResource DropdownMenuItemStyle}" Click="mnuFontSize_Click"/>
            <MenuItem Header="Change Language" InputGestureText="Ctrl+G" Style="{StaticResource DropdownMenuItemStyle}"/>
            <MenuItem Header="Change Password" InputGestureText="Ctrl+W" Style="{StaticResource DropdownMenuItemStyle}" Click="mnuChangePassword_Click"/>
            <MenuItem Header="Manage Settings" Style="{StaticResource DropdownMenuItemStyle}" Click="ManageSettings_Click"/>
            <MenuItem x:Name="mnuRtoL" Header="Right To Left" IsCheckable="True" Style="{StaticResource DropdownMenuItemStyle}" Click="mnuRighttoleft_Click"/>
            <MenuItem Header="Apply Color Indicators" IsCheckable="True" IsChecked="True" Style="{StaticResource DropdownMenuItemStyle}"/>
            <MenuItem Header="About..." InputGestureText="Ctrl+B" Style="{StaticResource DropdownMenuItemStyle}" 
             Click="mnuAbout_Click"/>
          </MenuItem>

          <MenuItem Header="Alerts" Style="{StaticResource DropdownMenuItemStyle}">
            <MenuItem Header="Disable Alerts" InputGestureText="Ctrl+T" Style="{StaticResource DropdownMenuItemStyle}"/>
            <MenuItem Header="Mute" InputGestureText="Ctrl+M" Style="{StaticResource DropdownMenuItemStyle}"/>
            <MenuItem Header="Change Voice" InputGestureText="Ctrl+N" Style="{StaticResource DropdownMenuItemStyle}"/>
          </MenuItem>

          <MenuItem Header="PDF Options" Style="{StaticResource DropdownMenuItemStyle}">
            <MenuItem  x:Name="mnuAppViewer" Header="View Within Application Viewer" IsCheckable="True" IsChecked="True" Style="{StaticResource DropdownMenuItemStyle}" Click="mnuAppViewer_Click"/>
            <MenuItem x:Name="mnuExternalViewer" Header="View Externally With Acrobat Reader" IsCheckable="True" Style="{StaticResource DropdownMenuItemStyle}" Click="mnuExternalViewer_Click"/>
          </MenuItem>

          <MenuItem Header="Multi List Separator Options" Style="{StaticResource DropdownMenuItemStyle}">
            <MenuItem Header="Split On \" IsCheckable="True" IsChecked="True" Style="{StaticResource DropdownMenuItemStyle}" Click="SplitonBackslash_click"/>
            <MenuItem Header="Split On /" IsCheckable="True" IsChecked="True" Style="{StaticResource DropdownMenuItemStyle}"
              Click="SplitOnForwardSlash_Click"/>
            <MenuItem Header="Split On ;" IsCheckable="True" IsChecked="True" Style="{StaticResource DropdownMenuItemStyle}"
              Click="SplitOnSemicolon_Click"/>
            <MenuItem Header="Split On -" IsCheckable="True" Style="{StaticResource DropdownMenuItemStyle}"
            Click="SplitOnHyphen_Click"/>
            <MenuItem Header="Split On _" IsCheckable="True" Style="{StaticResource DropdownMenuItemStyle}"
              Click="SplitOnUnderscore_Click"/>
          </MenuItem>                                                                                                                                                                                                                                                                                                                                                                                                     
        </MenuItem>

        <MenuItem Header="Other Modules" Style="{StaticResource TopLevelMenuItemStyle}">
          <MenuItem Header="Monitor Processes" Style="{StaticResource DropdownMenuItemStyle}"/>
          <MenuItem Header="Simple Search" InputGestureText="F1" Style="{StaticResource DropdownMenuItemStyle}" Click="SimpleSearchMenuItem_Click"/>
          <MenuItem Header="Admin Reports" Style="{StaticResource DropdownMenuItemStyle}"/>
          <MenuItem Header="Post Announcement" Style="{StaticResource DropdownMenuItemStyle}" Click="PostAnnouncement_Click"/>
        </MenuItem>

        <MenuItem Header="Exit" Style="{StaticResource TopLevelMenuItemStyle}" Click="ExitMenu_Click"/>
      </Menu>
        
      <Grid Grid.Row="2">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="#F8F8F8" BorderBrush="#E0E0E0" BorderThickness="0,0,0.8,0" Padding="15">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <ListBox Grid.Row="1" BorderThickness="0" Background="Transparent">
              <ListBoxItem MouseLeftButtonUp="CaptureWindow_Click">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                  <Image Source="/Images/scannericon.png" Width="70" Height="70" ToolTip="Scan-Import-Capture-Files,Folders, and Paper Documents"/>
                </StackPanel>
              </ListBoxItem>

              <ListBoxItem MouseLeftButtonUp="WelcomeWindow_Click">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                  <Image Source="/Images/search_images.png" Width="80" Height="80" ToolTip="Search And Retrieve"/>
                </StackPanel>
              </ListBoxItem>

              <!-- Admin ListBoxItem - Add Name and Click handler -->
              <ListBoxItem x:Name="AdminListBoxItem" MouseLeftButtonUp="AdminListBoxItem_Click">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                  <Image Source="/Images/admin.png" Width="70" Height="70" ToolTip="Launch Admin Module" />
                </StackPanel>
              </ListBoxItem>
            </ListBox>

            <ListBox Grid.Row="2" BorderThickness="0" Background="Transparent" VerticalAlignment="Bottom" Margin="0,15,0,0">
              <ListBoxItem x:Name="LogoutListBoxItem" MouseLeftButtonUp="Logout_Click">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                  <Image Source="/Images/shutdown.png" Width="50" Height="50" ToolTip="Logout"/>
                </StackPanel>
              </ListBoxItem>
            </ListBox>
          </Grid>
        </Border>

        <!-- Right Content Area -->
        <Grid Grid.Column="1" Background="White">
          <!-- Existing Welcome Content (initially visible) -->
          <StackPanel x:Name="WelcomeContentPanel" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Image Source="/Images/logo.png" Height="150" Width="150" Margin="0,0,0,20"/>
            <TextBlock Text="HIJAZI_AND_GHOSHEH - Information Management Solutions"
                       FontSize="20" FontWeight="Bold" Foreground="#333333" TextAlignment="Center"/>
            <TextBlock Text="Welcome to your professional dashboard."
                       FontSize="16" Foreground="#666666" Margin="0,10,0,0" TextAlignment="Center"/>
          </StackPanel>
          <Border x:Name="ChangePasswordPanel"
        Background="White"
        BorderBrush="#FF5A5A5A"
        BorderThickness="2"
        Padding="25"
        Width="420"
        Height="270"
        HorizontalAlignment="Center"
        VerticalAlignment="Center"
        Visibility="Collapsed"
        CornerRadius="12">
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="5" Opacity="0.5"/>
            </Border.Effect>
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
              </Grid.RowDefinitions>

              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>

              <TextBlock Text="Old Password:" 
                   Grid.Row="0" Grid.Column="0" 
                   VerticalAlignment="Center" 
                   Margin="0,0,15,0"
                   FontWeight="SemiBold"
                   FontSize="14"/>
              <PasswordBox x:Name="OldPasswordBox" 
                     Grid.Row="0" Grid.Column="1" 
                     MinWidth="200"
                     Height="30"
                     Padding="5"/>

              <TextBlock Text="New Password:" 
                   Grid.Row="1" Grid.Column="0" 
                   VerticalAlignment="Center" 
                   Margin="0,15,15,0"
                   FontWeight="SemiBold"
                   FontSize="14"/>
              <PasswordBox x:Name="NewPasswordBox" 
                     Grid.Row="1" Grid.Column="1" 
                     MinWidth="200"
                     Height="30"
                     Margin="0,15,0,0"
                     Padding="5"/>

              <TextBlock Text="Confirm Password:" 
                   Grid.Row="2" Grid.Column="0" 
                   VerticalAlignment="Center" 
                   Margin="0,15,15,0"
                   FontWeight="SemiBold"
                   FontSize="14"/>
              <PasswordBox x:Name="ConfirmPasswordBox" 
                     Grid.Row="2" Grid.Column="1" 
                     MinWidth="200"
                     Height="30"
                     Margin="0,15,0,0"
                     Padding="5"/>

              <StackPanel Grid.Row="3" Grid.ColumnSpan="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,25,0,0" >
                <Button Content="Change Password" 
                    Width="140" 
                    Margin="0,0,15,0" 
                    Padding="7,3" 
                    FontWeight="Bold" 
                    Background="#FF007ACC" 
                    Foreground="White" 
                    BorderThickness="0"
                    Click="ChangePassword_Click"/>
                <Button Content="Cancel" 
                    Width="90" 
                    Padding="7,3"
                    Background="#FFE0E0E0" 
                    BorderBrush="#FFB0B0B0" 
                    Click="CancelChangePassword_Click"/>
              </StackPanel>
            </Grid>
          </Border>
          <Border>
          </Border>
          <!-- New Admin Content Panel (initially hidden) -->
          <StackPanel x:Name="AdminContentPanel" Orientation="Vertical"
                      HorizontalAlignment="Center" VerticalAlignment="Center"
                      Visibility="Collapsed">
            
            <TextBlock Text="Administration"
                       FontSize="28" Padding="8" FontWeight="Bold"  Foreground="#333333"
                       Margin="0,0,0,0" TextAlignment="Center"/>

            <Menu Background="White" HorizontalAlignment="Center" Margin="0,0,0,10">
              <MenuItem Header="General" Style="{StaticResource TopLevelMenuItemStyle}">
                <MenuItem Header="Migrate Audits And Alerts"
                          Style="{StaticResource DropdownMenuItemStyle}"
                          Click="MigrateAuditsAndAlerts_Click" />
              </MenuItem>
              <MenuItem Header="License Description"
                        Style="{StaticResource TopLevelMenuItemStyle}"
                        Click="LicenseDescription_Click"/>
              <MenuItem Header="Reserved Users Info"
                        Style="{StaticResource TopLevelMenuItemStyle}"
                        Click="ReservedUsersInfo_Click"/>   
            </Menu>

            <UniformGrid Columns="2" HorizontalAlignment="Center" VerticalAlignment="Center"
                         Width="Auto" MaxWidth="800">
              <!-- User Management Card -->
              <Button Click="Authority_Click" Style="{StaticResource TransparentButtonStyle}" Margin="0,15,0,0">
                <Border Style="{StaticResource AdminDashboardCardStyle}">
                  <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- Replaced fa:ImageAwesome with Image -->
                    <Image Source="/Images/folder.png" Width="120" Height="120" Margin="0,0,0,10"/>
                    <TextBlock Text="Authority" FontSize="20" FontWeight="SemiBold"
                             Foreground="#333333" TextAlignment="Center" Margin="0,0,0,5"/>

                  </StackPanel>
                </Border>
              </Button>

              <!-- System Settings Card -->
              <Button Click="Design_Click" Style="{StaticResource TransparentButtonStyle}" Margin="15,15,0,0">
                <Border Style="{StaticResource AdminDashboardCardStyle}">
                  <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- Replaced fa:ImageAwesome with Image -->
                    <Image Source="/Images/folderdesign.png" Width="120" Height="120" Margin="0,0,0,10"/>
                    <TextBlock Text="Design" FontSize="20" FontWeight="SemiBold"
                             Foreground="#333333" TextAlignment="Center" Margin="0,0,0,5"/>

                  </StackPanel>
                </Border>
              </Button>

              <!-- Audit Logs Card -->
              <Button Click="Integration_Click" Style="{StaticResource TransparentButtonStyle}" Margin="0,20,0,0">
                <Border Style="{StaticResource AdminDashboardCardStyle}">
                  <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- Replaced fa:ImageAwesome with Image -->
                    <Image Source="/Images/puzzle.png" Width="120" Height="120" Margin="0,0,0,10"/>
                    <TextBlock Text="Integration" FontSize="20" FontWeight="SemiBold"
                             Foreground="#333333" TextAlignment="Center" Margin="0,0,0,5"/>

                  </StackPanel>
                </Border>
              </Button>

              <!-- Database Management Card -->
              <!--<Border Style="{StaticResource AdminDashboardCardStyle}" Margin="15,15,0,15">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                  --><!-- Replaced fa:ImageAwesome with Image --><!--
                  <Image Source="/Images/process.png" Width="120" Height="120" Margin="0,0,0,10"/>
                  <TextBlock Text="Processes Design" FontSize="20" FontWeight="SemiBold"
                             Foreground="#333333" TextAlignment="Center" Margin="0,0,0,5"/>
                  
                </StackPanel>
              </Border>-->
              <Button Click="ProcessDesign_Click" Style="{StaticResource TransparentButtonStyle}" Margin="15,20,0,0">
                <Border Style="{StaticResource AdminDashboardCardStyle}">
               
                  <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Image Source="/Images/process.png" Width="120" Height="120" Margin="0,0,0,10"/>
                    <TextBlock Text="Processes Design" FontSize="20" FontWeight="SemiBold"
                       Foreground="#333333" TextAlignment="Center" Margin="0,0,0,5"/>
                  </StackPanel>
              
              </Border>
              </Button>
            </UniformGrid>
          </StackPanel>
        </Grid>
      </Grid>
      <Grid x:Name="overlayGrid" Grid.Row="0" Grid.RowSpan="4"
                  Background="#80000000"
                  Visibility="Collapsed"/>
    </Grid>
  </Border>
</Window>