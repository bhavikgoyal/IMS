<Window x:Class="IMS.CaptureWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:model="clr-namespace:IMS.Models.CaptureModel"
        mc:Ignorable="d"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FontFamily="Segoe UI"
        PreviewKeyDown="Window_PreviewKeyDown"
        Loaded="Window_Loaded">

  <Window.Resources>
    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="30"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarIconButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Margin" Value="5,1"/>
      <Setter Property="FontSize" Value="34"/>
      <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
      <Setter Property="Foreground" Value="#2C3E50"/>
      <Setter Property="ToolTipService.ShowOnDisabled" Value="True"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}" CornerRadius="2" Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="#E0E0E0"/>
          <Setter Property="Foreground" Value="#3498DB"/>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
          <Setter Property="Background" Value="#A0A0A0"/>
          <Setter Property="Foreground" Value="White"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style TargetType="{x:Type MenuItem}">
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Padding" Value="7,5"/>
      <Setter Property="Background" Value="White"/>
    </Style>

    <Style TargetType="{x:Type Menu}">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
    </Style>

    <DropShadowEffect x:Key="MaterialDesignShadowDepth1"
                          BlurRadius="8" Direction="270"
                          ShadowDepth="2" Opacity="0.12"
                          Color="#000000"/>

    <Style x:Key="ScannedDocumentListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Margin" Value="0,0,0,5"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="&#xE8F1;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="22"
                                           Margin="0,0,8,0"
                                           VerticalAlignment="Center">
                  <TextBlock.Style>
                    <Style TargetType="TextBlock">
                      <Setter Property="Foreground" Value="#3498DB"/>
                      <Style.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" Value="True">
                          <Setter Property="Foreground" Value="#3498DB"/>
                        </DataTrigger>
                      </Style.Triggers>
                    </Style>
                  </TextBlock.Style>
                </TextBlock>
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
              </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#E6F2F7"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC"/>
                <Setter TargetName="Bd" Property="BorderThickness" Value="1"/>
              </Trigger>
              <MultiTrigger>
                <MultiTrigger.Conditions>
                  <Condition Property="IsSelected" Value="True"/>
                  <Condition Property="Selector.IsSelectionActive" Value="False"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#DDDDDD"/>
              </MultiTrigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Foreground" Value="#333333"/>
    </Style>
  </Window.Resources>

  <Border Background="#F5F7FA" CornerRadius="0"
            BorderBrush="#FFE0E0E0" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#FFBBBBBB" Direction="270"
                              ShadowDepth="8" BlurRadius="25" Opacity="0.4"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="35"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <Border Grid.Row="0" Background="#FF333333"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown">
        <Grid>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <Image Source="/Images/logo.png" Width="20" Height="20" Margin="0,0,8,0"/>
            <TextBlock x:Name="HeaderTitleText" Margin="0,8,0,0"
                                   Foreground="White" FontSize="15" FontWeight="SemiBold"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE921;" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE922;" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeRestoreButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <Menu Grid.Row="1">

        <!-- Scanning -->
        <MenuItem Header="Scanning">
          <MenuItem Header="Enable Easylmport" x:Name="mnuEnableEasyImport" IsCheckable="True" IsChecked="False"  Click="mnuEnableEasyImport_Click"/>
          <MenuItem Header="Manage Easylmport Folders" Click="mnuManageEasyImportFolders_Click"/>
          <MenuItem Header="From Excel" Click="mnuFromExcel_Click"/>
          <MenuItem x:Name="mnuShortFieldSameAsExcel" Header="Short Field Name Same as Excel" IsCheckable="True" IsChecked="False" />
          <MenuItem Header="From Clip Board" x:Name="mnuFromClipboard" IsCheckable="True" Click="mnuFromClipboard_Click"/>
          <MenuItem Header="From Web" Click="mnuFromWeb_Click"/>
          <MenuItem Header="Import Tiff"/>
          <MenuItem Header="Record Only" InputGestureText="F5" Click="mnuRecordOnly_Click"/>
          <MenuItem Header="Scan Into"/>
          <MenuItem Header="Show Scanner Dialog"/>
          <MenuItem Header="Change Scanner"/>
          <MenuItem Header="Scanner Settings" Click="ScannerSettings_Click"/>
        </MenuItem>

        <!-- Batches -->
        <MenuItem Header="Batches">
          <MenuItem Header="New Batches" InputGestureText="Ctrl+F5" Click="mnuNewBatch_Click"/>
          <MenuItem Header="Select Current Batch" Click="mnuSelectBatch_Click"/>
          <MenuItem Header="Export Current Basket To Batch" Click="mnuBasketToBatch_Click"/>
          <MenuItem Header="Import Document From Batch" InputGestureText="F11" Click="mnuDocumentFromBatch_Click"/>
          <MenuItem Header="Import N Document From Batch" Click="mnuImportNFromBatch_Click"/>
          <MenuItem Header="Import All From Batch" InputGestureText="Ctrl+F11" Click="mnuAllDocumentFromBatch_Click"/>
        </MenuItem>

        <!-- Documents -->
        <MenuItem Header="Documents">
          <MenuItem Header="Print" InputGestureText="Ctrl+P"/>
          <MenuItem Header="Replicate Document" Click="mnuReplicateDocument_Click"/>
          <MenuItem Header="Delete All" Click="mnuDeleteAll_Click"/>
          <MenuItem Header="Delete Document" InputGestureText="Shift+Del" Click="mnuDeleteDocument_Click"/>
          <MenuItem Header="Delete Page" InputGestureText="Alt+Bksp" Click="mnuDeletePage_Click"/>
          <MenuItem Header="Merge" InputGestureText="Ctrl+M" Click="mnuMerge_Click"/>
          <MenuItem Header="Split" InputGestureText="Ctrl+T" Click="mnuSplit_Click"/>
          <MenuItem Header="Split Into" Click="mnuSplitInto_Click"/>
          <MenuItem Header="Multi Split" Click="mnuMultiSplit_Click"/>
          <MenuItem Header="Merge All" Click="mnuMergeAll_Click"/>
          <MenuItem Header="Enable Intelligent Split" InputGestureText="Ctrl+F6"/>
          <MenuItem Header="Intelligent Split" InputGestureText="F6"/>
          <MenuItem x:Name="mnuEnableOnClickMerge" Header="Enable On Click Merge" IsCheckable="True" Click="mnuEnableOnClickMerge_Click"/>
          <MenuItem Header="Enable Page Reorder By Mouse"/>
          <MenuItem Header="Approve Document" InputGestureText="Ctrl+D" Click="mnuApproveDocument_Click"/>
          <MenuItem Header="Approve All" InputGestureText="Ctrl+A" Click="mnuApproveAll_click"/>
          <MenuItem Header="Ignore Approve Errors" IsCheckable="True"/>
          <MenuItem x:Name="mnuDragDropMerge" Header="Enable Drag Drop Merge" IsCheckable="True" Click="mnuDragDropMerge_Click"/>
          <MenuItem x:Name="mnuApproveImmediate" Header="Approve Immediate" IsCheckable="True" />
          <MenuItem x:Name="mnuImportEachFolderAs1Document" Header="Import Each Folder As 1 Document" IsCheckable="True" Click="mnuImportEachFolderAs1Document_Click"/>
          <MenuItem Header="Delete After Import" IsCheckable="True" IsChecked="False" Click="mnuDeleteAfterImport_Click"/>
        </MenuItem>

        <!-- Fields -->
        <MenuItem Header="Fields">
          <MenuItem Header="Show All Dialogs" InputGestureText="Ctrl+F8"/>
          <MenuItem Header="Keep Entries"  IsCheckable="True" Click="mnuKeepEntries_Click"/>
          <MenuItem Header="Save Fields" InputGestureText="Ctrl+S" Click="mnuSaveFields_Click"/>
          <MenuItem Header="Apply To All" InputGestureText="Ctrl+U" Click="mnuApplyToAll_Click"/>
          <MenuItem Header="Select All Fields" IsCheckable="True" InputGestureText="Ctrl+F" Click="SelectAllFields_Click"/>
          <MenuItem Header="Save To MS Word" InputGestureText="Ctrl+W"/>
          <MenuItem Header="Undo Save To Word" InputGestureText="Ctrl+Z"/>
          <MenuItem Header="Integrate" InputGestureText="F12" Click="mnuIntegrate_Click"/>
          <MenuItem Header="Partial Integration"/>
          <MenuItem Header="Bring First Value"/>
          <MenuItem Header="Set Focus On Current Selected Field" Click="mnuSetFocusOnCurrentSelectedField_Click"/>
          <MenuItem Header="Clear" InputGestureText="Ctrl+L" Click="mnuClear_Click"/>
        </MenuItem>

        <!-- Stamps/Signatures -->
        <MenuItem Header="Stamps/Signatures">
          <MenuItem Header="No Password for Signatures"/>
          <MenuItem Header="Sign Document" InputGestureText="Ctrl+N"/>
          <MenuItem Header="Stamp Document"/>
          <MenuItem Header="Burn Immediate"/>
          <MenuItem Header="Approve Immediately After Sign"/>
          <MenuItem Header="Approve Immediately After Stamp"/>
        </MenuItem>

        <!-- Image -->
        <MenuItem Header="Image">
          <MenuItem Header="Zoom In" InputGestureText="F4" Click="mnuZoomIn_Click"/>
          <MenuItem Header="Zoom Out" InputGestureText="F3" Click="mnuZoomOut_Click"/>
          <MenuItem Header="Fit To Width" Click="mnuFitToWidth_Click"/>
          <MenuItem Header="Fit To Height" Click="mnuFitToHeight_Click"/>
          <MenuItem Header="Rotate Left" InputGestureText="F1" Click="mnuRotateLeft_Click"/>
          <MenuItem Header="Rotate Right" InputGestureText="F2" Click="mnuRotateRight_Click"/>
          <MenuItem Header="Enable Image Compression"/>
          <MenuItem Header="Enable Text-Image Compression"/>
          <MenuItem Header="Auto Compression"/>
          <MenuItem Header="Enable Image Clipping"/>
          <MenuItem Header="Clip and Keep Focus On Original"/>
          <MenuItem Header="Secure For Me Only"/>
          <MenuItem Header="Enable Content Security"/>
          <MenuItem Header="Clear Content Security"/>
        </MenuItem>

        <!-- Annotations -->
        <MenuItem Header="Annotations">
          <MenuItem Header="Show Edit Dialog" InputGestureText="Shift+F1"/>
          <MenuItem Header="Save Annotations Without Burn In" InputGestureText="Shift+F2"/>
          <MenuItem Header="Burn In Annotations" InputGestureText="Shift+F3"/>
          <MenuItem Header="Edit Annotations" InputGestureText="Shift+F4" Click="mnuEditAnnotations_Click"/>
          <MenuItem Header="Insert Predefined Text Annotations" InputGestureText="Shift+F5"/>
          <MenuItem Header="Show/Hide Annotations" InputGestureText="Shift+F6" IsCheckable="True" IsChecked="True"/>
          <MenuItem Header="Show All Layers" InputGestureText="Shift+F12"/>
          <MenuItem Header="Next Layer" InputGestureText="Shift+F8"/>
          <MenuItem Header="Previous Layer" InputGestureText="Shift+F7"/>
          <MenuItem Header="Add Annotation Layer" InputGestureText="Shift+F9"/>
          <MenuItem Header="Delete Layer" InputGestureText="Shift+F10"/>
          <MenuItem Header="Delete All Layers" InputGestureText="Shift+F11"/>
        </MenuItem>

        <!-- General -->
        <MenuItem Header="General">
          <MenuItem Header="Tool Bars" IsCheckable="True" IsChecked="True"/>
          <MenuItem Header="Edit Image" InputGestureText="Ctrl+E"/>
          <MenuItem Header="Email Alert"/>
          <MenuItem Header="Export Basket" InputGestureText="F7"/>
          <MenuItem Header="Import Basket" InputGestureText="F8"/>
          <MenuItem Header="Search Screen" InputGestureText="F9"/>
          <MenuItem Header="Change Language" InputGestureText="Ctrl+G"/>
          <MenuItem Header="Disable Messages" IsCheckable="True" IsChecked="True"/>
        </MenuItem>

        <!-- OCR -->
        <MenuItem Header="OCR">

          <MenuItem Header="Enable Manual Zonal OCR"/>
          <MenuItem Header="Split On OCR"/>

          <MenuItem Header="Barcode">
            <MenuItem Header="Split Basket On Barcode"/>
            <MenuItem Header="Delete Original Document"/>
          </MenuItem>

          <MenuItem Header="Templates">
            <MenuItem Header="Choose OCR Template"/>
            <MenuItem Header="Create/Modify OCR Templates"/>
            <MenuItem Header="Save Template"/>
          </MenuItem>

          <MenuItem Header="Unattended Mode">
            <MenuItem Header="Auto OCR and Index"/>
            <MenuItem Header="Auto Integreat"/>
          </MenuItem>

          <MenuItem Header="OCR Whole Page">
            <MenuItem Header="OCR Current Image"/>
            <MenuItem Header="OCR Current Document"/>
            <MenuItem Header="OCR Whole Basket"/>
          </MenuItem>
          <MenuItem Header= "Remove Blank Lines"/>
          <MenuItem Header=" Remove Spaces"/>
          <MenuItem Header="Only Numbers"/>
          <MenuItem Header="Character Length"/>
        </MenuItem>

        <!-- Next/Prev -->
        <MenuItem Header="&lt;&lt;">
          <MenuItem Header="Previous"/>
        </MenuItem>

        <MenuItem Header="&gt;&gt;">
          <MenuItem Header="Next"/>
        </MenuItem>

        <!-- Exit -->
        <MenuItem Header="Exit" Click="ExitMenuItem_Click"/>

      </Menu>


      <Border Grid.Row="2" Background="White" BorderBrush="Transparent" BorderThickness="0,0,0,1" Padding="5,3">
        <ToolBarTray Background="Transparent">
          <ToolBar Band="1" BandIndex="1" Background="Transparent" BorderThickness="0">
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE294;" ToolTip="Scan" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8E5;" ToolTip="Import File" Click="ImportFileButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xED25;" ToolTip="Import Folder" Click="ImportFolderButton_Click" />
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8F4;" ToolTip="Record Without Document" Click="RecordWithoutDocument_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE74E;" ToolTip="Save Fields" Click="SaveFieldsButton_Click" />
            <Button Style="{StaticResource ToolBarIconButtonStyle}" FontFamily="Segoe MDL2 Assets" Content="&#xEA35;" ToolTip="Save Selected Field to All Document in Basket" Click="SaveSelectedFieldsToAllButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8AB;" ToolTip="Integrate" Click="IntegrateButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7B8;" ToolTip="Send to Archive" Foreground="#00AA00" Click="SendToArchiveButton_Click" />
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xEC59;" ToolTip="Send to All Archive"  Click="SendAllToArchiveButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE74D;" ToolTip="Delete All From Basket" Click="DeleteAllFromBasketButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Delete Current Document" Click="DeleteCurrentDocumentButton_Click">
              <Image Source="/Images/remove-file.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Delete Current Page" Click="DeleteCurrentPageButton_Click">
              <Image Source="/Images/delete-folder.png" Width="38" Height="38"/>
            </Button>

            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split" Click="SplitCurrentDocument_Click" >
              <Image Source="/Images/direction.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Multi Split" Click="SplitAllDocument_Click" >
              <Image Source="/Images/split.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Merge" Click="MergeCurrentDocument_Click">
              <Image Source="/Images/merge.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Merge All Document" Click="MergeAllDocument_Click">
              <Image Source="/Images/mergeallicon.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8A3;" ToolTip="Zoom In" Foreground="#007ACC"  Click=" ZoomInButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE71F;" ToolTip="Zoom Out" Foreground="#007ACC"  Click=" ZoomOutButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7A7;" ToolTip="RotateLeft" Foreground="#00AA00" Click="RotateLeftButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7A6;" ToolTip="RotateRight" Foreground="#00AA00" Click="RotateRightButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Fit To Width" Click="FitToWidthButton_Click">
              <Image Source="/Images/arrows.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Fit Height" Click="FitToHeightButton_Click">
              <Image Source="/Images/height.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Sign In">
              <Image Source="/Images/stamp.png" Width="40" Height="40"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Stamp">
              <Image Source="/Images/stamp.png" Width="40" Height="40"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Save Selected Field To Word File">
              <Image Source="/Images/wfile.png" Width="40" Height="40"/>
            </Button>
          </ToolBar>
        </ToolBarTray>
      </Border>

      <Grid Grid.Row="3" Margin="8">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="270"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0" Margin="0,0,8,0">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="220"/>
          </Grid.RowDefinitions>

          <Border Grid.Row="0"
                            Background="#FFFFFF" CornerRadius="3"
                            Effect="{StaticResource MaterialDesignShadowDepth1}"
                            Margin="0,0,0,6">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <TextBlock Text="Data Cabinet"
                                       Foreground="#333333" FontSize="14" FontWeight="SemiBold"
                                       Padding="8" Background="#F0F0F0"/>

              <ScrollViewer Grid.Row="1"
                                          VerticalScrollBarVisibility="Auto"
                                          Margin="4">
                <TreeView x:Name="myTreeView"
                                          BorderThickness="0"
                                          BorderBrush="Transparent"
                                          SelectedItemChanged="CabinetTree_SelectedItemChanged"
                                          ItemsSource="{Binding PartnerTree}">
                  <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                      <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="&#xF12B;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Margin="0,0,6,0"
                                                           VerticalAlignment="Center"
                                                           Foreground="#3498DB" />
                        <TextBlock Text="{Binding LongIndexName}"
                                                           VerticalAlignment="Center"
                                                           FontSize="13"
                                                           Foreground="#333333" />
                      </StackPanel>
                    </HierarchicalDataTemplate>
                  </TreeView.ItemTemplate>
                </TreeView>
              </ScrollViewer>
            </Grid>
          </Border>

          <Border Grid.Row="1"
        Background="#FFFFFF" CornerRadius="3"
        Effect="{StaticResource MaterialDesignShadowDepth1}">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>
              
              <TextBlock Padding="8"
                   Background="#F0F0F0"
                   Foreground="#333333"
                   FontSize="14"
                   FontWeight="SemiBold">
            <Run Text="{Binding ScannedBatches.Count, Mode=OneWay}" />
            <Run Text="-Scanned Documents" />
              </TextBlock>

              <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto"
                      Margin="4">
                <TreeView x:Name="ScannedTreeView"
                      BorderThickness="0"
                      ItemsSource="{Binding ScannedBatches}"
                      SelectedItemChanged="ScannedTreeView_SelectedItemChanged"
                      PreviewMouseLeftButtonDown="ScannedTreeView_PreviewMouseLeftButtonDown"
                      PreviewMouseMove="ScannedTreeView_PreviewMouseMove"
                      PreviewDragOver="ScannedTreeView_PreviewDragOver"
                      Drop="ScannedTreeView_Drop" AllowDrop="True">

                  <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type model:ScanBatch}"
                                              ItemsSource="{Binding Pages}">
                      <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xE8B7;"
                                       FontFamily="Segoe MDL2 Assets"
                                       Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding FileNo}" />
                      </StackPanel>
                    </HierarchicalDataTemplate>

                    <DataTemplate DataType="{x:Type model:ScannedDocument}">
                      <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xE8F1;"
                                       FontFamily="Segoe MDL2 Assets"
                                       Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding PageNo}" />
                      </StackPanel>
                    </DataTemplate>
                  </TreeView.Resources>

                </TreeView>
              </ScrollViewer>
            </Grid>
          </Border>


        </Grid>
        <Border Grid.Column="1"
                        Background="#FFFFFF" CornerRadius="3"
                        Effect="{StaticResource MaterialDesignShadowDepth1}">
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="420"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <ScrollViewer Grid.Column="0"
                                      VerticalScrollBarVisibility="Auto"
                                      Margin="6">
              <ItemsControl x:Name="FieldsItemsControl" ItemsSource="{Binding Fields}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <Grid Margin="0,2">
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                      </Grid.ColumnDefinitions>

                      <CheckBox Grid.Column="0"
                  IsChecked="{Binding IsChecked}"
                  VerticalAlignment="Center"
                  Margin="2,0,6,0"/>

                      <TextBlock Grid.Column="1"
                   Text="{Binding Caption}"
                   Foreground="Red"
                   FontSize="13"
                   VerticalAlignment="Center"
                   TextWrapping="Wrap"
                   MinWidth="120"/>

                      <TextBox Grid.Column="2"
                 Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                 FontSize="13"
                 Height="22"
                 Margin="4,0,4,0"
                 VerticalContentAlignment="Center"
                 HorizontalAlignment="Stretch"
                 MinWidth="180"/>
                    </Grid>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </ScrollViewer>

            <Border Grid.Column="1"
                  Margin="0,6,6,6"
                  Background="#F4F4F4"
                  BorderBrush="#D0D0D0"
                  BorderThickness="1">    
              <Grid>
                <!-- 🔹 WEB VIEW (NEW) -->
                <wv2:WebView2 x:Name="WebBrowserView"
                          Visibility="Collapsed"/>
               
                <ScrollViewer x:Name="TextScrollViewer"
                      VerticalScrollBarVisibility="Auto">
                  <TextBox x:Name="DocumentTextViewer"
                     Margin="4"
                     IsReadOnly="True"
                     AcceptsReturn="True"
                     AcceptsTab="True"
                     TextWrapping="Wrap"
                     BorderThickness="0"
                     FontFamily="Consolas"
                     FontSize="13"
                     VerticalScrollBarVisibility="Auto"/>
                </ScrollViewer>

                <ScrollViewer x:Name="ImageScrollViewer"
              Visibility="Collapsed"
              HorizontalScrollBarVisibility="Auto"
              VerticalScrollBarVisibility="Auto"
              HorizontalContentAlignment="Left"
              VerticalContentAlignment="Top">
                  <Image x:Name="DocumentImageViewer"
               HorizontalAlignment="Left"
               VerticalAlignment="Top"
               Stretch="Uniform"
               Margin="4">
                    <Image.LayoutTransform>
                      <TransformGroup>
                        <ScaleTransform x:Name="ImageScaleTransform" ScaleX="1" ScaleY="1" />
                        <RotateTransform x:Name="ImageLayoutRotateTransform" Angle="0" />
                      </TransformGroup>
                    </Image.LayoutTransform>
                  </Image>
                </ScrollViewer>
              </Grid>
            </Border>

          </Grid>
        </Border>
    
      </Grid>
    
      <Label x:Name="StatusLabel"
       Grid.Row="3"                     
       HorizontalAlignment="Center"
       VerticalAlignment="Top"
       Margin="0,40,0,0" 
       FontSize="35"
       FontWeight="Bold"
       Padding="8,4"
       Foreground="Green"
       Background="#CCFFFFFF"
        Visibility="Collapsed"
       Panel.ZIndex="999"/>

    </Grid>
  </Border>
</Window>
