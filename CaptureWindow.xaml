<Window x:Class="IMS.CaptureWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FontFamily="Segoe UI">

  <Window.Resources>
    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="30"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarIconButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Margin" Value="5,1"/>
      <Setter Property="FontSize" Value="34"/>
      <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
      <Setter Property="Foreground" Value="#2C3E50"/>
      <Setter Property="ToolTipService.ShowOnDisabled" Value="True"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}" CornerRadius="2" Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="#E0E0E0"/>
          <Setter Property="Foreground" Value="#3498DB"/>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
          <Setter Property="Background" Value="#A0A0A0"/>
          <Setter Property="Foreground" Value="White"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style TargetType="{x:Type MenuItem}">
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Padding" Value="7,5"/>
      <Setter Property="Background" Value="White"/>
    </Style>

    <Style TargetType="{x:Type Menu}">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
    </Style>

    <DropShadowEffect x:Key="MaterialDesignShadowDepth1"
                          BlurRadius="8" Direction="270"
                          ShadowDepth="2" Opacity="0.12"
                          Color="#000000"/>

    <Style x:Key="ScannedDocumentListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Margin" Value="0,0,0,5"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="&#xE8F1;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="22"
                                           Margin="0,0,8,0"
                                           VerticalAlignment="Center">
                  <TextBlock.Style>
                    <Style TargetType="TextBlock">
                      <Setter Property="Foreground" Value="#3498DB"/>
                      <Style.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" Value="True">
                          <Setter Property="Foreground" Value="#3498DB"/>
                        </DataTrigger>
                      </Style.Triggers>
                    </Style>
                  </TextBlock.Style>
                </TextBlock>
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
              </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#E6F2F7"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC"/>
                <Setter TargetName="Bd" Property="BorderThickness" Value="1"/>
              </Trigger>
              <MultiTrigger>
                <MultiTrigger.Conditions>
                  <Condition Property="IsSelected" Value="True"/>
                  <Condition Property="Selector.IsSelectionActive" Value="False"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#DDDDDD"/>
              </MultiTrigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Foreground" Value="#333333"/>
    </Style>
  </Window.Resources>

  <!-- ========== MAIN LAYOUT ========== -->
  <Border Background="#F5F7FA" CornerRadius="0"
            BorderBrush="#FFE0E0E0" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#FFBBBBBB" Direction="270"
                              ShadowDepth="8" BlurRadius="25" Opacity="0.4"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="35"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <Border Grid.Row="0" Background="#FF333333"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown">
        <Grid>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <Image Source="/Images/logo.png" Width="20" Height="20" Margin="0,0,8,0"/>
            <TextBlock Text="Capture" Margin="0,8,0,0"
                                   Foreground="White" FontSize="15" FontWeight="SemiBold"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE921;" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE922;" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeRestoreButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <Menu Grid.Row="1">
        <MenuItem Header="Scanning">
          <MenuItem Header="New Scan"/>
          <MenuItem Header="Batch Scan"/>
          <MenuItem Header="Import File"/>
          <MenuItem Header="Import Folder"/>
        </MenuItem>
        <MenuItem Header="Batches">
          <MenuItem Header="Manage Batches"/>
          <MenuItem Header="Archive Batches"/>
        </MenuItem>
        <MenuItem Header="Documents">
          <MenuItem Header="Create Document"/>
          <MenuItem Header="Merge Documents"/>
          <MenuItem Header="Split Document"/>
        </MenuItem>
        <MenuItem Header="Fields">
          <MenuItem Header="Define Fields"/>
          <MenuItem Header="Populate Fields"/>
        </MenuItem>
        <MenuItem Header="Stamps/Signatures">
          <MenuItem Header="Apply Stamp"/>
          <MenuItem Header="Add Signature"/>
        </MenuItem>
        <MenuItem Header="Image">
          <MenuItem Header="Rotate"/>
          <MenuItem Header="Crop"/>
          <MenuItem Header="Brightness/Contrast"/>
          <MenuItem Header="Grayscale"/>
        </MenuItem>
        <MenuItem Header="Annotations">
          <MenuItem Header="Add Text"/>
          <MenuItem Header="Highlight"/>
          <MenuItem Header="Redact"/>
        </MenuItem>
        <MenuItem Header="General">
          <MenuItem Header="Settings"/>
          <MenuItem Header="Help"/>
        </MenuItem>
        <MenuItem Header="OCR">
          <MenuItem Header="Perform OCR"/>
          <MenuItem Header="OCR Settings"/>
        </MenuItem>
        <MenuItem Header="&lt;&lt;">
          <MenuItem Header="Previous"/>
        </MenuItem>
        <MenuItem Header="&gt;&gt;">
          <MenuItem Header="Next"/>
        </MenuItem>
        <MenuItem Header="Exit" Click="ExitMenuItem_Click"/>
      </Menu>

      <Border Grid.Row="2" Background="White" BorderBrush="Transparent" BorderThickness="0,0,0,1" Padding="5,3">
        <ToolBarTray Background="Transparent">
          <ToolBar Band="1" BandIndex="1" Background="Transparent" BorderThickness="0">
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE294;" ToolTip="Scan" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}"
                                Content="&#xE8E5;" ToolTip="Import File"
                                Click="ImportFileButton_Click"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xED25;" ToolTip="Import Folder"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8F4;" ToolTip="Print Document"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE74E;" ToolTip="Cut"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}"
                                FontFamily="Segoe MDL2 Assets"
                                Content="&#xEA35;"
                                ToolTip="Save All"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8AB;" ToolTip="Paste"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7B8;" ToolTip="Redo" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xEC59;" ToolTip="Paste"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE74D;" ToolTip="Paste"/>


            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split">
              <Image Source="/Images/remove-file.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split All">
              <Image Source="/Images/delete-folder.png" Width="38" Height="38"/>
            </Button>

            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split">
              <Image Source="/Images/direction.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split All">
              <Image Source="/Images/split.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Merge">
              <Image Source="/Images/merge.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Merge All">
              <Image Source="/Images/mergeallicon.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8A3;" ToolTip="Zoom In" Foreground="#007ACC"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE71F;" ToolTip="Zoom Out" Foreground="#007ACC"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7A7;" ToolTip="Undo" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7A6;" ToolTip="Redo" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Fit Width">
              <Image Source="/Images/arrows.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Fit Height">
              <Image Source="/Images/height.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Stamp">
              <Image Source="/Images/stamp.png" Width="40" Height="40"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Scan">
              <Image Source="/Images/wfile.png" Width="40" Height="40"/>
            </Button>
          </ToolBar>
        </ToolBarTray>
      </Border>

      <!-- ===== MAIN CONTENT ===== -->
      <Grid Grid.Row="3" Margin="8">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="270"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT: Data Cabinet + Scanned Documents -->
        <Grid Grid.Column="0" Margin="0,0,8,0">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="220"/>
          </Grid.RowDefinitions>

          <!-- Data Cabinet -->
          <Border Grid.Row="0"
                            Background="#FFFFFF" CornerRadius="3"
                            Effect="{StaticResource MaterialDesignShadowDepth1}"
                            Margin="0,0,0,6">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <TextBlock Text="Data Cabinet"
                                       Foreground="#333333" FontSize="14" FontWeight="SemiBold"
                                       Padding="8" Background="#F0F0F0"/>

              <ScrollViewer Grid.Row="1"
                                          VerticalScrollBarVisibility="Auto"
                                          Margin="4">
                <TreeView x:Name="myTreeView"
                                          BorderThickness="0"
                                          BorderBrush="Transparent"
                                          SelectedItemChanged="CabinetTree_SelectedItemChanged"
                                          ItemsSource="{Binding PartnerTree}">
                  <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                      <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="&#xF12B;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Margin="0,0,6,0"
                                                           VerticalAlignment="Center"
                                                           Foreground="#3498DB" />
                        <TextBlock Text="{Binding LongIndexName}"
                                                           VerticalAlignment="Center"
                                                           FontSize="13"
                                                           Foreground="#333333" />
                      </StackPanel>
                    </HierarchicalDataTemplate>
                  </TreeView.ItemTemplate>
                </TreeView>
              </ScrollViewer>
            </Grid>
          </Border>

          <!-- Scanned Documents -->
          <Border Grid.Row="1"
                            Background="#FFFFFF" CornerRadius="3"
                            Effect="{StaticResource MaterialDesignShadowDepth1}">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <TextBlock Padding="8"
                                       Background="#F0F0F0"
                                       Foreground="#333333"
                                       FontSize="14"
                                       FontWeight="SemiBold">
                                <Run Text="{Binding ScannedDocuments.Count, Mode=OneWay}" />
                                <Run Text="-Scanned Documents" />
              </TextBlock>

              <ScrollViewer Grid.Row="1"
                                          VerticalScrollBarVisibility="Auto"
                                          Margin="4">
                <ListBox x:Name="ScannedDocumentsListBox"
                                         BorderThickness="0"
                                         BorderBrush="Transparent"
                                         ItemContainerStyle="{StaticResource ScannedDocumentListBoxItemStyle}"
                                         ItemsSource="{Binding ScannedDocuments}"
                                         DisplayMemberPath="FileName"
                                         SelectionChanged="ScannedDocumentsListBox_SelectionChanged"/>
              </ScrollViewer>
            </Grid>
          </Border>
        </Grid>
        <Border Grid.Column="1"
                        Background="#FFFFFF" CornerRadius="3"
                        Effect="{StaticResource MaterialDesignShadowDepth1}">
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="420"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <ScrollViewer Grid.Column="0"
                                      VerticalScrollBarVisibility="Auto"
                                      Margin="6">
              <ItemsControl ItemsSource="{Binding Fields}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <Grid Margin="0,2">
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                      </Grid.ColumnDefinitions>

                      <CheckBox Grid.Column="0"
                  IsChecked="{Binding IsChecked}"
                  VerticalAlignment="Center"
                  Margin="2,0,6,0"/>

                      <TextBlock Grid.Column="1"
                   Text="{Binding Caption}"
                   Foreground="Red"
                   FontSize="13"
                   VerticalAlignment="Center"
                   TextWrapping="Wrap"
                   MinWidth="120"/>

                      <TextBox Grid.Column="2"
                 Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                 FontSize="13"
                 Height="22"
                 Margin="4,0,4,0"
                 VerticalContentAlignment="Center"
                 HorizontalAlignment="Stretch"
                 MinWidth="180"/>
                    </Grid>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </ScrollViewer>

            <!-- Viewer full height -->
            <Border Grid.Column="1"
                                Margin="0,6,6,6"
                                Background="#F4F4F4"
                                BorderBrush="#D0D0D0"
                                BorderThickness="1">
              <ScrollViewer VerticalScrollBarVisibility="Auto">
                <TextBox x:Name="DocumentTextViewer"
                                         Margin="4"
                                         IsReadOnly="True"
                                         AcceptsReturn="True"
                                         AcceptsTab="True"
                                         TextWrapping="Wrap"
                                         BorderThickness="0"
                                         FontFamily="Consolas"
                                         FontSize="13"
                                         VerticalScrollBarVisibility="Auto"/>
              </ScrollViewer>
            </Border>
          </Grid>
        </Border>
      </Grid>
    </Grid>
  </Border>
</Window>
