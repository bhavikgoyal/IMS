<Window x:Class="IMS.CaptureWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IMS"
        mc:Ignorable="d"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FontFamily="Segoe UI">

  <Window.Resources>
    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="30"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarIconButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Margin" Value="5,1"/>
      <Setter Property="FontSize" Value="34"/>
      <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
      <Setter Property="Foreground" Value="#2C3E50"/>
      <Setter Property="ToolTipService.ShowOnDisabled" Value="True"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}" CornerRadius="2" Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="#E0E0E0"/>
          <Setter Property="Foreground" Value="#3498DB"/>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
          <Setter Property="Background" Value="#A0A0A0"/>
          <Setter Property="Foreground" Value="White"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style TargetType="{x:Type MenuItem}">
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Padding" Value="7,5"/>
      <Setter Property="Background" Value="White"/>
    </Style>

    <Style TargetType="{x:Type Menu}">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
    </Style>

    <DropShadowEffect x:Key="MaterialDesignShadowDepth1"
                            BlurRadius="8" Direction="270" ShadowDepth="2" Opacity="0.12" Color="#000000"/>

    <ControlTemplate x:Key="CustomTreeViewItemTemplate" TargetType="{x:Type TreeViewItem}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ToggleButton x:Name="Expander"
                          IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                          ClickMode="Press"
                          Grid.Column="0" Grid.Row="0"
                          VerticalAlignment="Center" HorizontalAlignment="Left"
                          Focusable="False"
                          Width="18" Height="18" Margin="0,0,5,0">
          <ToggleButton.Template>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
              <Border Width="18" Height="18" CornerRadius="2" Background="Transparent" SnapsToDevicePixels="True">
                <Path x:Name="ExpandPath"
                                  Data="M 0 0 L 4 4 L 0 8 Z"
                                  Stroke="#333333" StrokeThickness="1" Fill="Transparent"
                                  HorizontalAlignment="Center" VerticalAlignment="Center">
                  <Path.LayoutTransform>
                    <RotateTransform Angle="0"/>
                  </Path.LayoutTransform>
                </Path>
              </Border>
              <ControlTemplate.Triggers>
                <Trigger Property="IsChecked" Value="True">
                  <Setter TargetName="ExpandPath" Property="LayoutTransform">
                    <Setter.Value>
                      <RotateTransform Angle="90"/>
                    </Setter.Value>
                  </Setter>
                  <Setter TargetName="ExpandPath" Property="Data" Value="M 0 0 L 8 0 L 4 4 Z"/>
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </ToggleButton.Template>
        </ToggleButton>

        <Border x:Name="HeaderBorder"
                    Grid.Column="1" Grid.Row="0"
                    Padding="5,7" Margin="0,1,0,1"
                    CornerRadius="3"
                    BorderThickness="1" BorderBrush="Transparent"
                    Background="Transparent"
                    SnapsToDevicePixels="True">
          <ContentPresenter x:Name="PART_Header"
                                  ContentSource="Header"
                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
        </Border>

        <ItemsPresenter x:Name="ItemsHost"
                            Grid.Column="1" Grid.Row="1"
                            Margin="15,0,0,0" Visibility="Collapsed"/>
      </Grid>

      <ControlTemplate.Triggers>
        <Trigger Property="IsExpanded" Value="True">
          <Setter TargetName="ItemsHost" Property="Visibility" Value="Visible"/>
        </Trigger>

        <Trigger Property="HasItems" Value="False">
          <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
        </Trigger>

        <Trigger Property="IsMouseOver" Value="True">
          <Setter TargetName="HeaderBorder" Property="Background" Value="#F0F0F0"/>
          <Setter TargetName="HeaderBorder" Property="BorderBrush" Value="Transparent"/>
        </Trigger>

        <Trigger Property="IsSelected" Value="True">
          <Setter TargetName="HeaderBorder" Property="Background" Value="#E6F2F7"/>
          <Setter TargetName="HeaderBorder" Property="BorderBrush" Value="#007ACC"/>
        </Trigger>
      </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style x:Key="CabinetTreeViewItemStyle" TargetType="TreeViewItem">
      <Setter Property="Template" Value="{StaticResource CustomTreeViewItemTemplate}"/>

      <Setter Property="HeaderTemplate">
        <Setter.Value>
          <DataTemplate>
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
              <TextBlock Text="&#xF12B;"
                         FontFamily="Segoe MDL2 Assets"
                         FontSize="22"
                         Margin="0,0,8,0"
                         VerticalAlignment="Center">
                <TextBlock.Style>
                  <Style TargetType="TextBlock">
                    <Setter Property="Foreground" Value="#3498DB"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type TreeViewItem}}, Path=IsSelected}" Value="True">
                        <Setter Property="Foreground" Value="#3498DB"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </TextBlock.Style>
              </TextBlock>

              <TextBlock Text="{Binding}"
                         VerticalAlignment="Center"
                         FontSize="16">
                <TextBlock.Style>
                  <Style TargetType="TextBlock">
                    <Setter Property="Foreground" Value="#333333"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type TreeViewItem}}, Path=IsSelected}" Value="True">
                        <Setter Property="Foreground" Value="#333333"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </TextBlock.Style>
              </TextBlock>
            </StackPanel>
          </DataTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="Padding" Value="0"/>
      <Setter Property="Margin" Value="0"/>
      <Setter Property="Background" Value="Transparent"/>
    </Style>

    <Style x:Key="ScannedDocumentListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Margin" Value="0,0,0,5"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Padding="{TemplateBinding Padding}"
                    SnapsToDevicePixels="true">
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="&#xE8F1;"
                           FontFamily="Segoe MDL2 Assets"
                           FontSize="22"
                           Margin="0,0,8,0"
                           VerticalAlignment="Center">
                  <TextBlock.Style>
                    <Style TargetType="TextBlock">
                      <Setter Property="Foreground" Value="#3498DB"/>
                      <Style.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" Value="True">
                          <Setter Property="Foreground" Value="#3498DB"/>
                        </DataTrigger>
                      </Style.Triggers>
                    </Style>
                  </TextBlock.Style>
                </TextBlock>
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
              </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#E6F2F7"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC"/>
                <Setter TargetName="Bd" Property="BorderThickness" Value="1"/>
              </Trigger>
              <MultiTrigger>
                <MultiTrigger.Conditions>
                  <Condition Property="IsSelected" Value="True"/>
                  <Condition Property="Selector.IsSelectionActive" Value="False"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="#DDDDDD"/>
              </MultiTrigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Foreground" Value="#333333"/>
    </Style>
  </Window.Resources>

  <Border Background="#F5F7FA" CornerRadius="0"
            BorderBrush="#FFE0E0E0" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#FFBBBBBB" Direction="270"
                              ShadowDepth="8" BlurRadius="25" Opacity="0.4"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="35"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <Border Grid.Row="0" Background="#FF333333"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown">
        <Grid>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <Image Source="/Images/logo.png" Width="20" Height="20" Margin="0,0,8,0"/>
            <TextBlock Text="Capture" Margin="0,8,0,0"
                                   Foreground="White" FontSize="15" FontWeight="SemiBold"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE921;" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE922;" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeRestoreButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <Menu Grid.Row="1">

        <!-- Scanning -->
        <MenuItem Header="Scanning">
          <MenuItem Header="Enable Easylmport"/>
          <MenuItem Header="Manage Easylmport Folders" Click="ManageEasyImportFolders_Click"/>
          <MenuItem Header="From Excel"/>
          <MenuItem Header="Short Field Name Same as Excel"/>
          <MenuItem Header="From Clip Board"/>
          <MenuItem Header="From Web"/>
          <MenuItem Header="Import Tiff"/>
          <MenuItem Header="Record Only" InputGestureText="F5"/>
          <MenuItem Header="Scan Into"/>
          <MenuItem Header="Show Scanner Dialog"/>
          <MenuItem Header="Change Scanner"/>
          <MenuItem Header="Scanner Settings"/>
        </MenuItem>

        <!-- Batches -->
        <MenuItem Header="Batches">
          <MenuItem Header="New Batches" InputGestureText="Ctrl+F5"/>
          <MenuItem Header="Select Current Batch"/>
          <MenuItem Header="Export Current Basket To Batch"/>
          <MenuItem Header="Import Document From Batch" InputGestureText="F11"/>
          <MenuItem Header="Import N Document From Batch"/>
          <MenuItem Header="Import All From Batch" InputGestureText="Ctrl+F11"/>
        </MenuItem>

        <!-- Documents -->
        <MenuItem Header="Documents">
          <MenuItem Header="Print" InputGestureText="Ctrl+P"/>
          <MenuItem Header="Replicate Document"/>
          <MenuItem Header="Delete Document" InputGestureText="Shift+Del"/>
          <MenuItem Header="Delete Page" InputGestureText="Alt+Bksp"/>
          <MenuItem Header="Delete All"/>
          <MenuItem Header="Merge" InputGestureText="Ctrl+M"/>
          <MenuItem Header="Split" InputGestureText="Ctrl+T"/>
          <MenuItem Header="Split Into"/>
          <MenuItem Header="Multi Split"/>
          <MenuItem Header="Merge All"/>
          <MenuItem Header="Enable Intelligent Split" InputGestureText="Ctrl+F6"/>
          <MenuItem Header="Intelligent Split" InputGestureText="F6"/>
          <MenuItem Header="Enable On Click Merge"/>
          <MenuItem Header="Enable Page Reorder By Mouse"/>
          <MenuItem Header="Approve Document" InputGestureText="Ctrl+D"/>
          <MenuItem Header="Approve All" InputGestureText="Ctrl+A"/>
          <MenuItem Header="Ignore Approve Errors" IsCheckable="True"/>
          <MenuItem Header="Enable Drag Drop Merge" IsCheckable="True"/>
          <MenuItem Header="Approve Immediate" IsCheckable="True" IsChecked="True"/>
          <MenuItem Header="Import Each Folder As 1 Document" IsCheckable="True"/>
          <MenuItem Header="Delete After Import" IsCheckable="True" IsChecked="True"/>
        </MenuItem>

        <!-- Fields -->
        <MenuItem Header="Fields">
          <MenuItem Header="Show All Dialogs" InputGestureText="Ctrl+F8"/>
          <MenuItem Header="Keep Entries"/>
          <MenuItem Header="Save Fields" InputGestureText="Ctrl+S"/>
          <MenuItem Header="Apply To All" InputGestureText="Ctrl+U"/>
          <MenuItem Header="Select All Fields" InputGestureText="Ctrl+F"/>
          <MenuItem Header="Save To MS Word" InputGestureText="Ctrl+W"/>
          <MenuItem Header="Undo Save To Word" InputGestureText="Ctrl+Z"/>
          <MenuItem Header="Integrate" InputGestureText="F12"/>
          <MenuItem Header="Partial Integration"/>
          <MenuItem Header="Bring First Value"/>
          <MenuItem Header="Set Focus On Current Selected Field"/>
          <MenuItem Header="Clear" InputGestureText="Ctrl+L"/>
        </MenuItem>

        <!-- Stamps/Signatures -->
        <MenuItem Header="Stamps/Signatures">
          <MenuItem Header="No Password for Signatures"/>
          <MenuItem Header="Sign Document" InputGestureText="Ctrl+N"/>
          <MenuItem Header="Stamp Document"/>
          <MenuItem Header="Burn Immediate"/>
          <MenuItem Header="Approve Immediately After Sign"/>
          <MenuItem Header="Approve Immediately After Stamp"/>
        </MenuItem>

        <!-- Image -->
        <MenuItem Header="Image">
          <MenuItem Header="Zoom In" InputGestureText="F4"/>
          <MenuItem Header="Zoom Out" InputGestureText="F3"/>
          <MenuItem Header="Fit To Width"/>
          <MenuItem Header="Fit To Height"/>
          <MenuItem Header="Rotate Left" InputGestureText="F1"/>
          <MenuItem Header="Rotate Right" InputGestureText="F2"/>
          <MenuItem Header="Enable Image Compression"/>
          <MenuItem Header="Enable Text-Image Compression"/>
          <MenuItem Header="Auto Compression"/>
          <MenuItem Header="Enable Image Clipping"/>
          <MenuItem Header="Clip and Keep Focus On Original"/>
          <MenuItem Header="Secure For Me Only"/>
          <MenuItem Header="Enable Content Security"/>
          <MenuItem Header="Clear Content Security"/>
        </MenuItem>

        <!-- Annotations -->
        <MenuItem Header="Annotations">
          <MenuItem Header="Show Edit Dialog" InputGestureText="Shift+F1"/>
          <MenuItem Header="Save Annotations Without Burn In" InputGestureText="Shift+F2"/>
          <MenuItem Header="Burn In Annotations" InputGestureText="Shift+F3"/>
          <MenuItem Header="Edit Annotations" InputGestureText="Shift+F4"/>
          <MenuItem Header="Insert Predefined Text Annotations" InputGestureText="Shift+F5"/>
          <MenuItem Header="Show/Hide Annotations" InputGestureText="Shift+F6" IsCheckable="True" IsChecked="True"/>
          <MenuItem Header="Show All Layers" InputGestureText="Shift+F12"/>
          <MenuItem Header="Next Layer" InputGestureText="Shift+F8"/>
          <MenuItem Header="Previous Layer" InputGestureText="Shift+F7"/>
          <MenuItem Header="Add Annotation Layer" InputGestureText="Shift+F9"/>
          <MenuItem Header="Delete Layer" InputGestureText="Shift+F10"/>
          <MenuItem Header="Delete All Layers" InputGestureText="Shift+F11"/>
        </MenuItem>

        <!-- General -->
        <MenuItem Header="General">
          <MenuItem Header="Tool Bars" IsCheckable="True" IsChecked="True"/>
          <MenuItem Header="Edit Image" InputGestureText="Ctrl+E"/>
          <MenuItem Header="Email Alert"/>
          <MenuItem Header="Export Basket" InputGestureText="F7"/>
          <MenuItem Header="Import Basket" InputGestureText="F8"/>
          <MenuItem Header="Search Screen" InputGestureText="F9"/>
          <MenuItem Header="Change Language" InputGestureText="Ctrl+G"/>
          <MenuItem Header="Disable Messages" IsCheckable="True" IsChecked="True"/>
        </MenuItem>

        <!-- OCR -->
        <MenuItem Header="OCR">

          <MenuItem Header="Enable Manual Zonal OCR"/>
          <MenuItem Header="Split On OCR"/>

          <MenuItem Header="Barcode">
            <MenuItem Header="Split Basket On Barcode"/>
            <MenuItem Header="Delete Original Document"/>
          </MenuItem>

          <MenuItem Header="Templates">
            <MenuItem Header="Choose OCR Template"/>
            <MenuItem Header="Create/Modify OCR Templates"/>
            <MenuItem Header="Save Template"/>
          </MenuItem>

          <MenuItem Header="Unattended Mode">
            <MenuItem Header="Auto OCR and Index"/>
            <MenuItem Header="Auto Integreat"/>
          </MenuItem>

          <MenuItem Header="OCR Whole Page">
            <MenuItem Header="OCR Current Image"/>
            <MenuItem Header="OCR Current Document"/>
            <MenuItem Header="OCR Whole Basket"/>
          </MenuItem>
          <MenuItem Header= "Remove Blank Lines"/>
          <MenuItem Header=" Remove Spaces"/>
          <MenuItem Header="Only Numbers"/>
          <MenuItem Header="Character Length"/>
        </MenuItem>

        <!-- Next/Prev -->
        <MenuItem Header="&lt;&lt;">
          <MenuItem Header="Previous"/>
        </MenuItem>

        <MenuItem Header="&gt;&gt;">
          <MenuItem Header="Next"/>
        </MenuItem>

        <!-- Exit -->
        <MenuItem Header="Exit" Click="ExitMenuItem_Click"/>

      </Menu>


      <Border Grid.Row="2" Background="White" BorderBrush="Transparent" BorderThickness="0,0,0,1" Padding="5,3">
        <ToolBarTray Background="Transparent">
          <ToolBar Band="1" BandIndex="1" Background="Transparent" BorderThickness="0">
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE294;" ToolTip="Scan" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8E5;" ToolTip="Import File"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xED25;" ToolTip="Import Folder"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8F4;" ToolTip="Print Document"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE74E;" ToolTip="Cut"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}"
                                FontFamily="Segoe MDL2 Assets"
                                Content="&#xEA35;"
                                ToolTip="Save All"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8AB;" ToolTip="Paste"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7B8;" ToolTip="Redo" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xEC59;" ToolTip="Paste"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE74D;" ToolTip="Paste"/>


            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split">
              <Image Source="/Images/remove-file.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split All">
              <Image Source="/Images/delete-folder.png" Width="38" Height="38"/>
            </Button>

            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split">
              <Image Source="/Images/direction.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Split All">
              <Image Source="/Images/split.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Merge">
              <Image Source="/Images/merge.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Merge All">
              <Image Source="/Images/mergeallicon.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE8A3;" ToolTip="Zoom In" Foreground="#007ACC"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE71F;" ToolTip="Zoom Out" Foreground="#007ACC"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7A7;" ToolTip="Undo" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE7A6;" ToolTip="Redo" Foreground="#00AA00"/>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Fit Width">
              <Image Source="/Images/arrows.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Fit Height">
              <Image Source="/Images/height.png" Width="38" Height="38"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Stamp">
              <Image Source="/Images/stamp.png" Width="40" Height="40"/>
            </Button>
            <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Scan">
              <Image Source="/Images/wfile.png" Width="40" Height="40"/>
            </Button>
          </ToolBar>
        </ToolBarTray>
      </Border>

      <Grid Grid.Row="3" Margin="10">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="300"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0" Margin="0,0,10,0">
          <Grid.RowDefinitions>
            <RowDefinition Height="100"/>
            <RowDefinition Height="300"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>
          <Border Grid.Row="0" Grid.RowSpan="2"
        Background="#FFFFFF" CornerRadius="5" 
        Effect="{StaticResource MaterialDesignShadowDepth1}" Margin="0,0,0,10">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <TextBlock Text="Data Cabinet"
                   Foreground="#333333" FontSize="16" FontWeight="SemiBold"
                   Padding="10" Background="#F0F0F0" />

              <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="5">
                <TreeView x:Name="myTreeView"
                    BorderThickness="0"
                    BorderBrush="Transparent"
                    SelectedItemChanged="CabinetTree_SelectedItemChanged"
                    ItemsSource="{Binding PartnerTree}">
                  <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                      <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="&#xF12B;"
                     FontFamily="Segoe MDL2 Assets"
                     FontSize="18"
                     Margin="0,0,6,0"
                     VerticalAlignment="Center"
                     Foreground="#3498DB" />
                        <TextBlock Text="{Binding LongIndexName}"
                     VerticalAlignment="Center"
                     FontSize="14"
                     Foreground="#333333" />
                      </StackPanel>
                    </HierarchicalDataTemplate>
                  </TreeView.ItemTemplate>
                </TreeView>
              </ScrollViewer>
            </Grid>
          </Border>

          <Border Grid.Row="2" Grid.RowSpan="2"
        Background="#FFFFFF" CornerRadius="5" Effect="{StaticResource MaterialDesignShadowDepth1}"
        Margin="0,10,0,0">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <TextBlock Text="Scanned Documents"
                   Foreground="#333333" FontSize="16" FontWeight="SemiBold"
                   Padding="10" Background="#F0F0F0" />

              <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="5">
                <ListBox BorderThickness="0" BorderBrush="Transparent"
                     ItemContainerStyle="{StaticResource ScannedDocumentListBoxItemStyle}">
                  <ListBoxItem Content="Document_2023_001.pdf"/>
                  <ListBoxItem Content="Invoice_ABC_123.tiff"/>
                  <ListBoxItem Content="Contract_XYZ.jpg"/>
                  <ListBoxItem Content="Report_Q4_2023.pdf"/>
                  <ListBoxItem Content="Form_P-500.tiff"/>
                  <ListBoxItem Content="Additional_Doc_1.pdf"/>
                  <ListBoxItem Content="Another_Scan_2.tiff"/>
                  <ListBoxItem Content="Project_Brief.docx"/>
                  <ListBoxItem Content="Meeting_Notes.txt"/>
                  <ListBoxItem Content="Old_Agreement.pdf"/>
                  <ListBoxItem Content="Scan_Batch_005.pdf"/>
                  <ListBoxItem Content="Final_Report.pdf"/>
                </ListBox>
              </ScrollViewer>
            </Grid>
          </Border>

        </Grid>
        <Border Grid.Column="1"
        Background="#FFFFFF" CornerRadius="5"
        Effect="{StaticResource MaterialDesignShadowDepth1}"
        Margin="0,0,0,0">
          <ScrollViewer VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Fields}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Grid Margin="0,1">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto"/>
                      <ColumnDefinition Width="220"/>
                      <ColumnDefinition Width="250"/>
                    </Grid.ColumnDefinitions>

                    <CheckBox Grid.Column="0"
                      IsChecked="{Binding IsChecked}"
                      VerticalAlignment="Center"
                      Margin="2,0,2,0"/>

                    <TextBlock Grid.Column="1"
                       Text="{Binding Caption}"
                       Foreground="Red"
                       FontSize="13"
                       VerticalAlignment="Center"
                       Margin="2,0"/>

                    <TextBox Grid.Column="2"
                     Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                     FontSize="13"
                     Height="22"
                     Margin="2,0,2,0"
                     VerticalContentAlignment="Center"/>
                  </Grid>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </ScrollViewer>
        </Border>
      </Grid>
    </Grid>
  </Border>
</Window>