<Window x:Class="IMS.SimpleSearchWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IMS"
        mc:Ignorable="d"
        WindowStartupLocation="CenterScreen"
        Title="SimpleSearchWindow"
        Height="700" Width="1000"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FontFamily="Segoe UI">

  <!-- ✅ Styles and resources -->
  <Window.Resources>

    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="35"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Close Button Style -->
    <Style x:Key="CloseButtonStyle" TargetType="Button">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="35"/>
      <Setter Property="Margin" Value="0,0,2,0"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="#fff"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="Bold"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="HorizontalContentAlignment" Value="Center"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FFDDDD"/>
                <Setter Property="Foreground" Value="#E74C3C"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#E74C3C"/>
                <Setter Property="Foreground" Value="White"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Style for Main Menu Items -->
    <Style TargetType="{x:Type MenuItem}">
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Padding" Value="7,5"/>
      <Setter Property="Background" Value="White"/>
    </Style>

    <Style TargetType="{x:Type Menu}">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
    </Style>
    <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
      <Setter Property="SnapsToDevicePixels" Value="True" />
      <Setter Property="OverridesDefaultStyle" Value="True" />
      <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
      <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
      <Setter Property="FontSize" Value="16" />
      <Setter Property="Background" Value="White" />
      <Setter Property="BorderBrush" Value="#CCC" />
      <Setter Property="Foreground" Value="#333" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ComboBox">
            <Grid>
              <!-- Border for main box -->
              <Border x:Name="Border"
        Background="{TemplateBinding Background}"
        BorderBrush="{TemplateBinding BorderBrush}"
        BorderThickness="1"
        CornerRadius="5"
        Padding="5"
        SnapsToDevicePixels="True" />
              <!-- Editable TextBox (will be visible when IsEditable=True) -->
              <TextBox x:Name="PART_EditableTextBox"
        Style="{x:Null}"
        Margin="8,0,25,0"
        VerticalAlignment="Center"
        HorizontalAlignment="Left"
        Focusable="True"
        Background="Transparent"
        BorderThickness="0"
        Visibility="Collapsed"
        IsReadOnly="{TemplateBinding IsReadOnly}" />
              <!-- ContentPresenter (will be visible when IsEditable=False) -->
              <ContentPresenter x:Name="PART_ContentPresenter"
        Margin="8,0,25,0"
        VerticalAlignment="Center"
        HorizontalAlignment="Left"
        Content="{TemplateBinding SelectionBoxItem}"
        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
        ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
        RecognizesAccessKey="True"
        Visibility="Visible" />
              <!-- Initially visible -->
              <!-- Dropdown arrow button -->
              <ToggleButton x:Name="DropDownToggle"
        IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
        Focusable="False"
        ClickMode="Press"
        Background="Transparent"
        BorderBrush="Transparent"
        HorizontalAlignment="Right"
        VerticalAlignment="Center"
        Width="30"
        Height="40" Padding="5,0,5,0"
        Margin="0,0,0,0">
                <Path Data="M 0 0 L 4 4 L 8 0 Z"
        Fill="#555"
        Width="12"
        Stretch="Uniform"
        HorizontalAlignment="Center"
        VerticalAlignment="Center" />
              </ToggleButton>
              <!-- Popup (the dropdown list) -->
              <Popup x:Name="Popup"
        Placement="Bottom"
        IsOpen="{TemplateBinding IsDropDownOpen}"
        AllowsTransparency="True"
        Focusable="False"
        PopupAnimation="Slide">
                <Grid MaxHeight="200"
        Width="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}"
        SnapsToDevicePixels="True">
                  <Border x:Name="DropDownBorder"
        Background="White"
        BorderBrush="#CCC"
        BorderThickness="1"
        CornerRadius="4"
        Margin="0,2,0,0" />
                  <ScrollViewer Margin="4,2,4,2"
        SnapsToDevicePixels="True">
                    <StackPanel IsItemsHost="True"
        KeyboardNavigation.DirectionalNavigation="Contained" />
                  </ScrollViewer>
                </Grid>
              </Popup>
            </Grid>
            <!-- States -->
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsFocused" Value="True">
                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
              <Trigger Property="HasItems" Value="False">
                <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
              </Trigger>
              <!-- Trigger for editable state -->
              <Trigger Property="IsEditable" Value="True">
                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible" />
                <Setter TargetName="PART_ContentPresenter" Property="Visibility" Value="Collapsed" />
                <Setter Property="IsTabStop" Value="False" />
                <Setter Property="KeyboardNavigation.IsTabStop" Value="False" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ModernCheckBoxStyle" TargetType="{x:Type CheckBox}">
      <Setter Property="Foreground" Value="#333333" />
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Padding" Value="8,0,0,0" />
      <!-- Increased padding for text -->
      <Setter Property="VerticalContentAlignment" Value="Center" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type CheckBox}">
            <Grid Background="Transparent">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <!-- Custom CheckBox Square -->
              <Border x:Name="CheckBoxBorder"
         Grid.Column="0"
         Width="18" Height="18"
         BorderBrush="#B0B0B0"
         BorderThickness="1.5"
         Background="White"
         CornerRadius="4"
         VerticalAlignment="Center"
         HorizontalAlignment="Left"
         Margin="0,0,5,0">
                <Path x:Name="CheckMark"
         Width="10" Height="10"
         Stretch="Uniform"
         Fill="White"
         Data="M 0 5 L 3 8 L 8 0 L 0 5 Z"
         RenderTransformOrigin="0.5,0.5"
         Visibility="Collapsed">
                  <Path.RenderTransform>
                    <ScaleTransform ScaleX="0" ScaleY="0" />
                  </Path.RenderTransform>
                </Path>
              </Border>
              <!-- Content Presenter for the CheckBox Text -->
              <ContentPresenter Grid.Column="1"
         Margin="{TemplateBinding Padding}"
         VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
         HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
         SnapsToDevicePixels="True"
         RecognizesAccessKey="True" />
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="CheckBoxBorder" Property="Background" Value="#0078D7" />
                <!-- Deeper blue -->
                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#0078D7" />
                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                <Trigger.EnterActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleX)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleY)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleX)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleY)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.ExitActions>
              </Trigger>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarIconButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Margin" Value="5,1"/>
      <Setter Property="FontSize" Value="30"/>
      <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
      <Setter Property="Foreground" Value="#2C3E50"/>
      <Setter Property="ToolTipService.ShowOnDisabled" Value="True"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}" CornerRadius="2" Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="#E0E0E0"/>
          <Setter Property="Foreground" Value="#3498DB"/>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
          <Setter Property="Background" Value="#A0A0A0"/>
          <Setter Property="Foreground" Value="White"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style x:Key="ModernHeaderStyle" TargetType="GridViewColumnHeader">
      <Setter Property="Background" Value="#ddd"/>
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="Padding" Value="10,8"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="HorizontalContentAlignment" Value="Left"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="GridViewColumnHeader">
            <Border x:Name="HeaderBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">
              <ContentPresenter x:Name="HeaderContent"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="HeaderBorder" Property="Background" Value="#ccc"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="HeaderBorder" Property="Background" Value="#ccc"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>
    
    

  </Window.Resources>

  <!-- ✅ Main layout -->
  <Border Background="#F5F7FA" CornerRadius="0" BorderBrush="Transparent" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect BlurRadius="25" Opacity="0.2" ShadowDepth="8" Direction="270" Color="#000000"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <!-- Custom Title Bar -->
      <Border Grid.Row="0" Background="#FF333333">
        <Grid>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <Image Source="/Images/logo.png" Width="20" Height="20" Margin="0,0,8,0"/>
            <TextBlock Text="Simple Search" Margin="0,8,0,0"
                             Foreground="White" FontSize="15" FontWeight="SemiBold"/>
          </StackPanel>

          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE921;" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE922;" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeRestoreButton_Click" FontFamily="Segoe MDL2 Assets"/>
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <Menu Grid.Row="1">
        <MenuItem Header="Options">
          <MenuItem Header="Zoom In" InputGestureText="F4"/>
          <MenuItem Header="Zoom Out" InputGestureText="F3"/>
          <MenuItem Header="Fit To Width" InputGestureText="F6"/>
          <MenuItem Header="Fit To Height" InputGestureText="F5"/>
          <MenuItem Header="Rotate Left" InputGestureText="F1"/>
          <MenuItem Header="Rotate Right" InputGestureText="F2"/>
          <MenuItem Header="Show First 4 Fields"/>
          <MenuItem Header="Show In Folder" InputGestureText="F7"/>
        </MenuItem>
        <MenuItem Header="Exit" Click="ExitMenuItem_Click"/>
      </Menu>

      <!-- Main Content Area - CORRECTED -->
      <Grid Grid.Row="2">
        <!-- Changed StackPanel to Grid here -->
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <!-- Removed Grid.RowDefinitions here -->

        <!-- Yellow Section - Now in Grid.Column="0" and implied Grid.Row="0" -->
        <Grid Grid.Column="0"  Margin="10,0,10,0">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header content takes only needed space -->
            <RowDefinition Height="*"/>
            <!-- This row takes all remaining space, allowing ScrollViewer to fill it -->
          </Grid.RowDefinitions>

          <StackPanel Grid.Row="0" Margin="0,10,0,0">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
              </Grid.ColumnDefinitions>
              <TextBlock Text="Cabinet" Foreground="#333333" FontSize="16" FontWeight="SemiBold" Height="40"
                       Grid.Column="0" Padding="10,8,10,10"/>
              <ComboBox x:Name="cmbCabs" Style="{StaticResource ModernComboBoxStyle}"  Grid.Column="1"  Height="40" Margin="10,10,20,10"
                      Text="" IsEditable="True" IsTextSearchEnabled="True">
                <!--<ComboBoxItem Content="Stage 1: Document Upload" />
                <ComboBoxItem Content="Stage 2: Initial Review" />
                <ComboBoxItem Content="Stage 3: Approval Process" />
                <ComboBoxItem Content="Stage 4: Final Processing" />
                <ComboBoxItem Content="Stage 5: Archiving" />-->
              </ComboBox>
              <StackPanel Grid.Column="2" Margin="0,0,0,0">
                <TextBlock Text="الارشيف" Foreground="#333333" FontSize="16" FontWeight="SemiBold"
                           Grid.Column="0" Padding="0,5,0,0" />
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Content="Fuzzy" Style="{StaticResource ModernCheckBoxStyle}" Grid.Column="0"
                              VerticalAlignment="Center" Margin="0,5,15,10"  IsChecked="True" />
                  <CheckBox Content="Show Docs" Style="{StaticResource ModernCheckBoxStyle}" Grid.Column="1"
                              VerticalAlignment="Center" Margin="0,5,0,10"  IsChecked="True" />
                </Grid>
              </StackPanel>
            </Grid>
          </StackPanel>

          <!-- ScrollViewer now in a row that takes remaining space -->
          <ScrollViewer Grid.Row="1" Padding="-2"
                  Background="#fff"
                  Margin="10,10,0,10"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Auto">
            <ScrollViewer.Effect>
              <DropShadowEffect Color="#FFBBBBBB" Direction="270" ShadowDepth="8" BlurRadius="25" Opacity="0.3" />
            </ScrollViewer.Effect>
            <ScrollViewer.Resources>
              <!-- Define the ControlTemplates separately -->
              <ControlTemplate x:Key="VerticalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
                <Grid x:Name="GridRoot" Width="{TemplateBinding Width}" Background="{TemplateBinding Background}">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="0.00001*"/>
                  </Grid.RowDefinitions>
                  <Track x:Name="PART_Track" Grid.Row="0"
                           IsDirectionReversed="true"
                           Focusable="false">
                    <Track.Thumb>
                      <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Width="{TemplateBinding Width}">
                        <Thumb.Template>
                          <ControlTemplate TargetType="{x:Type Thumb}">
                            <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                CornerRadius="5"
                                                Margin="1,0,1,0"/>
                          </ControlTemplate>
                        </Thumb.Template>
                      </Thumb>
                    </Track.Thumb>
                  </Track>
                </Grid>
              </ControlTemplate>

              <ControlTemplate x:Key="HorizontalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
                <Grid x:Name="GridRoot" Height="{TemplateBinding Height}" Background="{TemplateBinding Background}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.00001*"/>
                  </Grid.ColumnDefinitions>
                  <Track x:Name="PART_Track" Grid.Column="0"
                           IsDirectionReversed="false"
                           Focusable="false">
                    <Track.Thumb>
                      <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Height="{TemplateBinding Height}">
                        <Thumb.Template>
                          <ControlTemplate TargetType="{x:Type Thumb}">
                            <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                CornerRadius="5"
                                                Margin="0,1,0,1"/>
                          </ControlTemplate>
                        </Thumb.Template>
                      </Thumb>
                    </Track.Thumb>
                  </Track>
                </Grid>
              </ControlTemplate>

              <!-- Implicit Style for ScrollBar, applying templates based on Orientation -->
              <Style TargetType="{x:Type ScrollBar}">
                <Setter Property="Background" Value="Transparent"/>
                <!-- Default track background -->
                <Style.Triggers>
                  <Trigger Property="Orientation" Value="Vertical">
                    <Setter Property="Template" Value="{StaticResource VerticalScrollBarTemplate}"/>
                    <Setter Property="Width" Value="10"/>
                    <!-- Set your desired vertical width -->
                    <Setter Property="Margin" Value="0,1,0,1"/>
                  </Trigger>
                  <Trigger Property="Orientation" Value="Horizontal">
                    <Setter Property="Template" Value="{StaticResource HorizontalScrollBarTemplate}"/>
                    <Setter Property="Height" Value="10"/>
                    <!-- Set your desired horizontal height -->
                    <Setter Property="Margin" Value="1,0,1,0"/>
                  </Trigger>
                </Style.Triggers>
              </Style>

            </ScrollViewer.Resources>

            <ListView
            BorderThickness="0"
            Background="Transparent"
            VirtualizingPanel.IsVirtualizing="True"
            VirtualizingPanel.VirtualizationMode="Recycling"
            ScrollViewer.CanContentScroll="True"
            ScrollViewer.VerticalScrollBarVisibility="Auto"
            ScrollViewer.HorizontalScrollBarVisibility="Auto">
              <ListView.Resources>
                <Style TargetType="ListViewItem">
                  <Setter Property="Background" Value="Transparent"/>
                  <Setter Property="BorderThickness" Value="0"/>
                  <Setter Property="Padding" Value="0"/>
                  <Setter Property="Margin" Value="0"/>
                  <Setter Property="VerticalContentAlignment" Value="Center"/>
                  <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                  <Setter Property="Template">
                    <Setter.Value>
                      <ControlTemplate TargetType="ListViewItem">
                        <Border x:Name="Bd"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Background="{TemplateBinding Background}"
                                        Padding="{TemplateBinding Padding}"
                                        SnapsToDevicePixels="true">
                          <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                          <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#E0F0FF"/>
                          </Trigger>
                          <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#F5F5F5"/>
                          </Trigger>
                        </ControlTemplate.Triggers>
                      </ControlTemplate>
                    </Setter.Value>
                  </Setter>
                </Style>
              </ListView.Resources>

              <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                  <Setter Property="Height" Value="45"/>
                  <Setter Property="BorderThickness" Value="0,0,0,1"/>
                  <Setter Property="BorderBrush" Value="#E0E0E0"/>
                  <Setter Property="Margin" Value="0"/>
                  <Setter Property="Padding" Value="0"/>
                </Style>
              </ListView.ItemContainerStyle>

              <ListView.View>
                <GridView ColumnHeaderContainerStyle="{StaticResource ModernHeaderStyle}">
                  <GridViewColumn Header="Icon" Width="40">
                    <GridViewColumn.CellTemplate>
                      <DataTemplate>
                        <Image Source="Images/jpg.png"
                                       Width="25" Height="25"
                                       VerticalAlignment="Center"/>
                      </DataTemplate>
                    </GridViewColumn.CellTemplate>
                  </GridViewColumn>

                  <GridViewColumn Header="Fields" Width="Auto">
                    <GridViewColumn.CellTemplate>
                      <DataTemplate>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="5,0,0,0">
                          <TextBlock Text="{Binding emp_sec}" Foreground="#333" FontSize="13" Margin="0,0,15,0"/>
                          <TextBlock Text="{Binding emp_dept}" Foreground="#666" FontSize="13" Margin="0,0,15,0"/>
                          <TextBlock Text="{Binding company}" Foreground="#666" FontSize="13" Margin="0,0,15,0"/>
                          <TextBlock Text="{Binding empid}" Foreground="#333" FontWeight="SemiBold" FontSize="13" Margin="0,0,15,0"/>
                          <TextBlock Text="{Binding empname_a}" Foreground="#666" FontSize="13" Margin="0,0,15,0"/>
                        </StackPanel>
                      </DataTemplate>
                    </GridViewColumn.CellTemplate>
                  </GridViewColumn>
                </GridView>
              </ListView.View>

              <!-- Static Data -->
              <ListView.ItemsSource>
                <x:Array Type="{x:Type local:FileData}">
                  <local:FileData emp_sec="emp_sec: 12345" emp_dept="emp_dept: HR" company="company: ABC" empid="empid: 60045" empname_a="empname_a: John Doe"/>
                  <local:FileData emp_sec="emp_sec: 23456" emp_dept="emp_dept: IT" company="company: XYZ" empid="empid: 60065" empname_a="empname_a: Jane Smith"/>
                  <local:FileData emp_sec="emp_sec: 34567" emp_dept="emp_dept: Sales" company="company: GHI" empid="empid: 61217" empname_a="empname_a: Mike Ross"/>
                  <local:FileData emp_sec="emp_sec: 12345" emp_dept="emp_dept: HR" company="company: ABC" empid="empid: 60045" empname_a="empname_a: John Doe"/>
                  <local:FileData emp_sec="emp_sec: 23456" emp_dept="emp_dept: IT" company="company: XYZ" empid="empid: 60065" empname_a="empname_a: Jane Smith"/>
                  <local:FileData emp_sec="emp_sec: 34567" emp_dept="emp_dept: Sales" company="company: GHI" empid="empid: 61217" empname_a="empname_a: Mike Ross"/>
                  <local:FileData emp_sec="emp_sec: 45678" emp_dept="emp_dept: Marketing" company="company: LMN" empid="empid: 487" empname_a="empname_a: Rachel Green"/>
                  <local:FileData emp_sec="emp_sec: 56789" emp_dept="emp_dept: Finance" company="company: PQR" empid="empid: 1005" empname_a="empname_a: Harvey Specter"/>
                  <local:FileData emp_sec="emp_sec: 67890" emp_dept="emp_dept: Operations" company="company: STU" empid="empid: 1018" empname_a="empname_a: Donna Paulsen"/>
                  <local:FileData emp_sec="emp_sec: 78901" emp_dept="emp_dept: HR" company="company: VWX" empid="empid: 1036" empname_a="empname_a: Louis Litt"/>
                  <local:FileData emp_sec="emp_sec: 89012" emp_dept="emp_dept: IT" company="company: YZA" empid="empid: 1051" empname_a="empname_a: Jessica Pearson"/>
                  <local:FileData emp_sec="emp_sec: 90123" emp_dept="emp_dept: Sales" company="company: BCD" empid="empid: 1053" empname_a="empname_a: Katrina Bennett"/>
                  <local:FileData emp_sec="emp_sec: 01234" emp_dept="emp_dept: Marketing" company="company: EFG" empid="empid: 1061" empname_a="empname_a: Samantha Wheeler"/>
                  <local:FileData emp_sec="emp_sec: 11223" emp_dept="emp_dept: Finance" company="company: HIJ" empid="empid: 1075" empname_a="empname_a: Robert Zane"/>
                  <local:FileData emp_sec="emp_sec: 22334" emp_dept="emp_dept: Operations" company="company: KLM" empid="empid: 1078" empname_a="empname_a: Alex Williams"/>
                  <local:FileData emp_sec="emp_sec: 11223" emp_dept="emp_dept: Finance" company="company: HIJ" empid="empid: 1075" empname_a="empname_a: Robert Zane"/>
                  <local:FileData emp_sec="emp_sec: 22334" emp_dept="emp_dept: Operations" company="company: KLM" empid="empid: 1078" empname_a="empname_a: Alex Williams"/>
                  <local:FileData emp_sec="emp_sec: 11223" emp_dept="emp_dept: Finance" company="company: HIJ" empid="empid: 1075" empname_a="empname_a: Robert Zane"/>
                </x:Array>
              </ListView.ItemsSource>
            </ListView>
          </ScrollViewer>
        </Grid>   
        
        <!-- Red Section - Now in Grid.Column="1" and implied Grid.Row="0" -->
        <Grid Grid.Column="1" Margin="10,10,10,0">
          <!-- Changed Grid.Row="1" to Grid.Column="1" -->
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>
          <StackPanel Grid.Row="0" Margin="0,10,0,0">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
              </Grid.ColumnDefinitions>
              <!-- Dropdown (ComboBox) for Stage Name -->
              <Border Grid.Column="0" CornerRadius="5" BorderBrush="Transparent" BorderThickness="0" Background="White" Margin="0,0,5,0" Height="40">
                <TextBox x:Name="SearchTextBox" 
         Text="" 
         VerticalContentAlignment="Center" 
         Padding="5"  
         BorderBrush="#ccc"
         BorderThickness="1" 
         Background="White"
                  Foreground="#333"
         FontSize="16">
                  <TextBox.Resources>
                    <!-- Hide default focus visual -->
                    <Style TargetType="{x:Type TextBox}">
                      <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                      <Setter Property="Template">
                        <Setter.Value>
                          <ControlTemplate TargetType="{x:Type TextBox}">
                            <Border x:Name="Border"
                                CornerRadius="5"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                              <ScrollViewer x:Name="PART_ContentHost" Focusable="False" 
                                          HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"/>
                            </Border>
                            <ControlTemplate.Triggers>
                              <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#ccc" />
                              </Trigger>
                              <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#007ACC" />
                              </Trigger>
                              <Trigger Property="IsReadOnly" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F0F0F0" />
                                <Setter TargetName="Border" Property="BorderBrush" Value="#ccc" />
                              </Trigger>
                            </ControlTemplate.Triggers>
                          </ControlTemplate>
                        </Setter.Value>
                      </Setter>
                    </Style>
                  </TextBox.Resources>
                </TextBox>
              </Border>
              <StackPanel Grid.Column="2" Margin="0,0,0,0">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>
                  <Button Grid.Column="0" Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xE71E;" ToolTip="Search" Foreground="#3498DB"/>
                  <Button Grid.Column="1" Style="{StaticResource ToolBarIconButtonStyle}" Content="&#xF12B;" ToolTip="Show In Folder" Foreground="#3498DB"/>
                </Grid>
              </StackPanel>
            </Grid>
          </StackPanel>

          <ScrollViewer Grid.Row="1" 
         Background="#fff"
         Margin="0,15,10,10"
         VerticalScrollBarVisibility="Auto"
         HorizontalScrollBarVisibility="Auto">
            <ScrollViewer.Effect>
              <DropShadowEffect Color="#FFBBBBBB" Direction="270" ShadowDepth="8" BlurRadius="25" Opacity="0.3" />
            </ScrollViewer.Effect>

            <ScrollViewer.Resources>
              <!-- Define the ControlTemplates separately -->
              <ControlTemplate x:Key="VerticalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
                <Grid x:Name="GridRoot" Width="{TemplateBinding Width}" Background="{TemplateBinding Background}">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="0.00001*"/>
                  </Grid.RowDefinitions>
                  <Track x:Name="PART_Track" Grid.Row="0"
                  IsDirectionReversed="true"
                  Focusable="false">
                    <Track.Thumb>
                      <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Width="{TemplateBinding Width}">
                        <Thumb.Template>
                          <ControlTemplate TargetType="{x:Type Thumb}">
                            <Border Background="{TemplateBinding Background}"
                                       BorderBrush="{TemplateBinding BorderBrush}"
                                       CornerRadius="5"
                                       Margin="1,0,1,0"/>
                          </ControlTemplate>
                        </Thumb.Template>
                      </Thumb>
                    </Track.Thumb>
                  </Track>
                </Grid>
              </ControlTemplate>

              <ControlTemplate x:Key="HorizontalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
                <Grid x:Name="GridRoot" Height="{TemplateBinding Height}" Background="{TemplateBinding Background}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.00001*"/>
                  </Grid.ColumnDefinitions>
                  <Track x:Name="PART_Track" Grid.Column="0"
                  IsDirectionReversed="false"
                  Focusable="false">
                    <Track.Thumb>
                      <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Height="{TemplateBinding Height}">
                        <Thumb.Template>
                          <ControlTemplate TargetType="{x:Type Thumb}">
                            <Border Background="{TemplateBinding Background}"
                                       BorderBrush="{TemplateBinding BorderBrush}"
                                       CornerRadius="5"
                                       Margin="0,1,0,1"/>
                          </ControlTemplate>
                        </Thumb.Template>
                      </Thumb>
                    </Track.Thumb>
                  </Track>
                </Grid>
              </ControlTemplate>

              <!-- Implicit Style for ScrollBar, applying templates based on Orientation -->
              <Style TargetType="{x:Type ScrollBar}">
                <Setter Property="Background" Value="Transparent"/>
                <!-- Default track background -->
                <Style.Triggers>
                  <Trigger Property="Orientation" Value="Vertical">
                    <Setter Property="Template" Value="{StaticResource VerticalScrollBarTemplate}"/>
                    <Setter Property="Width" Value="10"/>
                    <!-- Set your desired vertical width -->
                    <Setter Property="Margin" Value="0,1,0,1"/>
                  </Trigger>
                  <Trigger Property="Orientation" Value="Horizontal">
                    <Setter Property="Template" Value="{StaticResource HorizontalScrollBarTemplate}"/>
                    <Setter Property="Height" Value="10"/>
                    <!-- Set your desired horizontal height -->
                    <Setter Property="Margin" Value="1,0,1,0"/>
                  </Trigger>
                </Style.Triggers>
              </Style>

            </ScrollViewer.Resources>

            <Border BorderThickness="0" Padding="20"
                    Background="Transparent"
                    VirtualizingPanel.IsVirtualizing="True"
                    VirtualizingPanel.VirtualizationMode="Recycling"
                    ScrollViewer.CanContentScroll="True"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto">

              <StackPanel>
                <!-- Header -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                  <Image Source="/Images/exclamation.png" 
                   Width="40" Height="40" 
                   Margin="0,0,10,0"/>
                  <TextBlock Text="The address is not valid"
                       FontSize="20"
                       FontWeight="Bold"
                       Foreground="#003399"
                       VerticalAlignment="Center"/>
                </StackPanel>

                <Separator Background="#FF99AAB5" Height="1" Margin="0,5,0,15"/>

                <!-- Description -->
                <StackPanel Margin="50,0,0,10">
                  <TextBlock Text="Most likely causes:"
                       FontWeight="SemiBold"
                       FontSize="18"
                       Margin="0,0,0,10"/>
                  <StackPanel Margin="15,0,0,10">
                    <TextBlock Text="• There might be a typing error in the address." 
                           FontSize="16"/>
                    <TextBlock Text="• If you clicked on a link, it may be out of date." Margin="0,5,0,0" 
                           FontSize="16"/>
                  </StackPanel>

                  <TextBlock Text="What you can try:" 
                       FontWeight="SemiBold"
                       FontSize="18"
                       Margin="0,30,0,10"/>
                  <StackPanel Margin="15,0,0,0">
                    <TextBlock Text="• Retype the address."
                           FontSize="16" 
                           Margin="0,0,0,5"/>
                    <TextBlock>
                    <Run Text="• " FontSize="16"/>
                    <Run Text="Go back to the previous page." 
                         FontSize="16"
                         Foreground="#003399"/>
                    </TextBlock>
                  </StackPanel>
                </StackPanel>
              </StackPanel>
            </Border>
          </ScrollViewer>
        </Grid>
      </Grid>
    </Grid>
  </Border>
</Window>