<Window x:Class="IMS.MigrateWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Migration Status"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterOwner"
        Height="170" Width="450" 
  Background="Transparent"
        WindowStyle="None"
        AllowsTransparency="True"
        FontFamily="Segoe UI">

  <Window.Resources>
    <!-- Custom Close Button Style (unchanged) -->
    <Style x:Key="CloseButtonStyle" TargetType="Button">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="35"/>
      <Setter Property="Margin" Value="0,0,2,0"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="#fff"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="Bold"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="HorizontalContentAlignment" Value="Center"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}" CornerRadius="0,0,0,0">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FFDDDD"/>
                <Setter Property="Foreground" Value="#E74C3C"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#E74C3C"/>
                <Setter Property="Foreground" Value="White"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Modern OK Button Style (unchanged) -->
    <Style x:Key="AccentButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="#007ACC"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Padding" Value="15,8"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border x:Name="ButtonBorder" CornerRadius="8"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
              <ContentPresenter x:Name="Content"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              TextElement.Foreground="{TemplateBinding Foreground}"
                                              Margin="{TemplateBinding Padding}"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="ButtonBorder" Property="Background">
                  <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                      <GradientStop Color="#007ACC" Offset="0"/>
                      <GradientStop Color="#3498DB" Offset="1"/>
                    </LinearGradientBrush>
                  </Setter.Value>
                </Setter>
                <Setter TargetName="ButtonBorder" Property="Effect">
                  <Setter.Value>
                    <DropShadowEffect BlurRadius="15" Opacity="0.4" Color="#007ACC" ShadowDepth="4"/>
                  </Setter.Value>
                </Setter>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="ButtonBorder" Property="Background" Value="#005C99"/>
                <Setter TargetName="ButtonBorder" Property="Effect">
                  <Setter.Value>
                    <DropShadowEffect BlurRadius="5" Opacity="0.2" Color="#007ACC" ShadowDepth="2"/>
                  </Setter.Value>
                </Setter>
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="ButtonBorder" Property="Background" Value="#CCCCCC"/>
                <Setter Property="Foreground" Value="#666666"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

  </Window.Resources>

  <Border Background="White" CornerRadius="0" BorderBrush="Transparent" BorderThickness="1"
            Padding="0" Margin="0">
    <Border.Effect>
      <DropShadowEffect BlurRadius="25" Opacity="0.2" ShadowDepth="8" Direction="270" Color="#000000"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <!-- Custom Title Bar -->
        <RowDefinition Height="*"/>
        <!-- Content -->
      </Grid.RowDefinitions>

      <!-- Custom Title Bar -->
      <Border Grid.Row="0" Background="#FF333333" CornerRadius="0"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown" Height="40">
        <Grid>
          <TextBlock Text="Migration Status"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#fff"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left" Margin="20,0,0,0"/>
          <Button Content="&#xE8BB;"
                            Style="{StaticResource CloseButtonStyle}"
                            HorizontalAlignment="Right"
                            FontFamily="Segoe MDL2 Assets"
                            Click="OkButton_Click"/>
        </Grid>
      </Border>

      <!-- Main Content Area -->
      <StackPanel Grid.Row="1" Margin="0">
        <!-- TextBlock to display the dynamic message -->
        <TextBlock x:Name="statusTextBlock"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="#333333"
                           Margin="0,20,0,30"
                           TextAlignment="Center"
                           Text="Done Successfully At: "/>
        <!-- Initial text, will be updated -->

        <Button Content="OK"
                        Width="150"
                        Height="35"
                        HorizontalAlignment="Center"
                        Style="{StaticResource AccentButtonStyle}"
                        Click="OkButton_Click"
                        Margin="0,0,0,0"/>
      </StackPanel>
    </Grid>
  </Border>
</Window>