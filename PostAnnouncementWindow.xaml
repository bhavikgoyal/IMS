<Window x:Class="IMS.PostAnnouncementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IMS"
        mc:Ignorable="d"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="Transparent"
        WindowStyle="None"
        AllowsTransparency="True"
        FontFamily="Segoe UI" Height="750" Width="768">
  <Window.Resources>
    <!-- Modern Button Style for Close Button -->
    <Style x:Key="CloseButtonStyle" TargetType="Button">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="35"/>
      <Setter Property="Margin" Value="0,0,2,0"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="#fff"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="Bold"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="HorizontalContentAlignment" Value="Center"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}" CornerRadius="0,0,0,0">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FFDDDD"/>
                <Setter Property="Foreground" Value="#E74C3C"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#E74C3C"/>
                <Setter Property="Foreground" Value="White"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Width" Value="35"/>
      <Setter Property="Height" Value="30"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border Background="{TemplateBinding Background}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#FF505050"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#FF707070"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Accent Button Style for OK button -->
    <Style x:Key="AccentButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="#007ACC"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Padding" Value="15,8"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Button}">
            <Border x:Name="ButtonBorder" CornerRadius="8"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
              <ContentPresenter x:Name="Content"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                TextElement.Foreground="{TemplateBinding Foreground}"
                                Margin="{TemplateBinding Padding}"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="ButtonBorder" Property="Background">
                  <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                      <GradientStop Color="#007ACC" Offset="0"/>
                      <GradientStop Color="#3498DB" Offset="1"/>
                    </LinearGradientBrush>
                  </Setter.Value>
                </Setter>
                <Setter TargetName="ButtonBorder" Property="Effect">
                  <Setter.Value>
                    <DropShadowEffect BlurRadius="15" Opacity="0.4" Color="#007ACC" ShadowDepth="4"/>
                  </Setter.Value>
                </Setter>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="ButtonBorder" Property="Background" Value="#005C99"/>
                <Setter TargetName="ButtonBorder" Property="Effect">
                  <Setter.Value>
                    <DropShadowEffect BlurRadius="5" Opacity="0.2" Color="#007ACC" ShadowDepth="2"/>
                  </Setter.Value>
                </Setter>
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="ButtonBorder" Property="Background" Value="#CCCCCC"/>
                <Setter Property="Foreground" Value="#666666"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Style for the detail TextBlocks -->
    <Style x:Key="DetailLabelStyle" TargetType="TextBlock">
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="FontSize" Value="15"/>
      <Setter Property="Foreground" Value="#555555"/>
      <Setter Property="Margin" Value="0,0,0,8"/>
      <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="DetailValueStyle" TargetType="TextBlock">
      <Setter Property="FontSize" Value="15"/>
      <Setter Property="Foreground" Value="#2D2D2D"/>
      <Setter Property="Margin" Value="0,0,0,8"/>
      <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>

    <Style x:Key="ModernHeaderStyle" TargetType="GridViewColumnHeader">
      <Setter Property="Background" Value="#ddd"/>
      <Setter Property="Foreground" Value="#333333"/>
      <Setter Property="Padding" Value="10,8"/>
      <Setter Property="BorderThickness" Value="0,0,0,1"/>
      <Setter Property="BorderBrush" Value="#E0E0E0"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="HorizontalContentAlignment" Value="Left"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="GridViewColumnHeader">
            <Border x:Name="HeaderBorder"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Padding="{TemplateBinding Padding}">
              <ContentPresenter x:Name="HeaderContent"
                                RecognizesAccessKey="True"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="HeaderBorder" Property="Background" Value="#ccc"/>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="HeaderBorder" Property="Background" Value="#ccc"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ModernListBoxStyle" TargetType="{x:Type ListBox}">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderThickness" Value="0" />
      <Setter Property="Padding" Value="0" />
      <Setter Property="SelectionMode" Value="Single" />
    </Style>

    <Style x:Key="ModernListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderThickness" Value="0" />
      <Setter Property="Margin" Value="0,0,0,2" />
      <Setter Property="Padding" Value="8" />
      <Setter Property="HorizontalContentAlignment" Value="Stretch" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Padding="{TemplateBinding Padding}"
                    CornerRadius="5"
                    SnapsToDevicePixels="true">
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <!-- User Icon -->
                <TextBlock Text="&#xE77B;"
                          FontFamily="Segoe MDL2 Assets"
                          FontSize="16"
                          Margin="0,0,10,0"
                          VerticalAlignment="Center"
                          Foreground="#3498DB" />
                <!-- Content Presenter for the ListBoxItem's text -->
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
              </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0" />
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#E6F2F7" />
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC" />
                <Setter TargetName="Bd" Property="BorderThickness" Value="1" />
              </Trigger>
              <MultiTrigger>
                <MultiTrigger.Conditions>
                  <Condition Property="IsSelected" Value="True" />
                  <Condition Property="Selector.IsSelectionActive" Value="False" />
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0" />
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC" />
              </MultiTrigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Foreground" Value="#333333" />
    </Style>

    <Style x:Key="ModernListBoxItemSecondStyle" TargetType="{x:Type ListBoxItem}">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderThickness" Value="0" />
      <Setter Property="Margin" Value="0,0,0,2" />
      <Setter Property="Padding" Value="8" />
      <Setter Property="HorizontalContentAlignment" Value="Stretch" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Padding="{TemplateBinding Padding}"
                    CornerRadius="5"
                    SnapsToDevicePixels="true">
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <!-- User Icon -->
                <TextBlock Text="&#xE902;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="22"
                                           Margin="0,0,10,0" FontWeight="ExtraLight"
                                           VerticalAlignment="Center"
                                           Foreground="#3498DB" />
                <!-- Content Presenter for the ListBoxItem's text -->
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
              </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0" />
              </Trigger>
              <Trigger Property="IsSelected" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="#E6F2F7" />
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC" />
                <Setter TargetName="Bd" Property="BorderThickness" Value="1" />
              </Trigger>
              <MultiTrigger>
                <MultiTrigger.Conditions>
                  <Condition Property="IsSelected" Value="True" />
                  <Condition Property="Selector.IsSelectionActive" Value="False" />
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd" Property="Background" Value="#F0F0F0" />
                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC" />
              </MultiTrigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Foreground" Value="#333333" />
    </Style>

    <Style x:Key="ModernCheckBoxStyle" TargetType="{x:Type CheckBox}">
      <Setter Property="Foreground" Value="#333333" />
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Padding" Value="8,0,0,0" />
      <!-- Increased padding for text -->
      <Setter Property="VerticalContentAlignment" Value="Center" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type CheckBox}">
            <Grid Background="Transparent">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <!-- Custom CheckBox Square -->
              <Border x:Name="CheckBoxBorder"
                                    Grid.Column="0"
                                    Width="18" Height="18"
                                    BorderBrush="#B0B0B0"
                                    BorderThickness="1.5"
                                    Background="White"
                                    CornerRadius="4"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Left"
                                    Margin="0,0,5,0">
                <Path x:Name="CheckMark"
                                      Width="10" Height="10"
                                      Stretch="Uniform"
                                      Fill="White"
                                      Data="M 0 5 L 3 8 L 8 0 L 0 5 Z"
                                      RenderTransformOrigin="0.5,0.5"
                                      Visibility="Collapsed">
                  <Path.RenderTransform>
                    <ScaleTransform ScaleX="0" ScaleY="0" />
                  </Path.RenderTransform>
                </Path>
              </Border>
              <!-- Content Presenter for the CheckBox Text -->
              <ContentPresenter Grid.Column="1"
                                Margin="{TemplateBinding Padding}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                SnapsToDevicePixels="True"
                                RecognizesAccessKey="True" />
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="CheckBoxBorder" Property="Background" Value="#0078D7" />
                <!-- Deeper blue -->
                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#0078D7" />
                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                <Trigger.EnterActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleX)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleY)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleX)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="CheckMark" Storyboard.TargetProperty="(Path.RenderTransform).(ScaleTransform.ScaleY)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.ExitActions>
              </Trigger>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ModernRadioButtonStyle" TargetType="{x:Type RadioButton}">
      <Setter Property="Foreground" Value="#333333" />
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Padding" Value="8,0,0,0" />
      <!-- Increased padding for text -->
      <Setter Property="VerticalContentAlignment" Value="Center" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type RadioButton}">
            <Grid Background="Transparent">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <!-- Custom RadioButton Outer Circle -->
              <Border x:Name="RadioButtonOuterCircle"
                                    Grid.Column="0"
                                    Width="18" Height="18"
                                    BorderBrush="#B0B0B0"
                                    BorderThickness="1.5"
                                    Background="White"
                                    CornerRadius="9"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Left"
                                    Margin="0,0,5,0">
                <Border x:Name="RadioButtonInnerCircle"
                                        Width="9" Height="9"
                                        Background="#0078D7"
                                        CornerRadius="5"
                                        Visibility="Collapsed">
                  <Border.RenderTransform>
                    <ScaleTransform ScaleX="0" ScaleY="0" />
                  </Border.RenderTransform>
                </Border>
              </Border>
              <!-- Content Presenter for the RadioButton Text -->
              <ContentPresenter Grid.Column="1"
                                Margin="{TemplateBinding Padding}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                SnapsToDevicePixels="True"
                                RecognizesAccessKey="True" />
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="RadioButtonOuterCircle" Property="BorderBrush" Value="#0078D7" />
                <Setter TargetName="RadioButtonInnerCircle" Property="Visibility" Value="Visible" />
                <Trigger.EnterActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)" To="1" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseOut" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                  <BeginStoryboard>
                    <Storyboard>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                      <DoubleAnimation Storyboard.TargetName="RadioButtonInnerCircle" Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)" To="0" Duration="0:0:0.15">
                        <DoubleAnimation.EasingFunction>
                          <CubicEase EasingMode="EaseIn" />
                        </DoubleAnimation.EasingFunction>
                      </DoubleAnimation>
                    </Storyboard>
                  </BeginStoryboard>
                </Trigger.ExitActions>
              </Trigger>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="RadioButtonOuterCircle" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarIconButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="Margin" Value="5,3"/>
      <Setter Property="FontSize" Value="34"/>
      <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
      <Setter Property="Foreground" Value="#2C3E50"/>
      <Setter Property="ToolTipService.ShowOnDisabled" Value="True"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}" CornerRadius="0" Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="LightGray"/>
          <Setter Property="Foreground" Value="#3498DB"/>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
          <Setter Property="Background" Value="LightBlue"/>
          <Setter Property="Foreground" Value="White"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style x:Key="ToolBarIconButtonStyleCheck" TargetType="ToggleButton">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Padding" Value="7,2,7,2"/>
      <Setter Property="Margin" Value="5,3,2,3"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ToggleButton">
            <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="0"
                                Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <!-- Hover -->
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Border" Property="Background" Value="LightGray"/>
              </Trigger>

              <!-- Checked -->
              <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="Border" Property="Background" Value="LightBlue"/>
                <Setter TargetName="Border" Property="BorderBrush" Value="#2196F3"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarIconToggleButtonStyle" TargetType="ToggleButton">
      <Setter Property="Margin" Value="2"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderBrush" Value="Transparent"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ToggleButton">
            <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsChecked" Value="True">
          <Setter Property="Background" Value="LightBlue"/>
        </Trigger>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="LightGray"/>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
          <Setter Property="Background" Value="Gray"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style x:Key="FocusedBorderStyle" TargetType="{x:Type TextBox}">
      <Setter Property="Height" Value="29" />
      <Setter Property="Padding" Value="0,10,0,10" />
      <Setter Property="FontSize" Value="14" />
      <Setter Property="Foreground" Value="#333" />
      <Setter Property="VerticalContentAlignment" Value="Top" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type TextBox}">
            <Border x:Name="OuterBorder"
                                BorderBrush="#CCC"
                                BorderThickness="1"
                                CornerRadius="0"
                                Padding="6.6,0,6.6,0"
                                Background="{TemplateBinding Background}">
              <ScrollViewer x:Name="PART_ContentHost" Focusable="False"
                                          HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden" />
            </Border>
            <ControlTemplate.Triggers>
              <!-- Change border color on IsMouseOver (hover) -->
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="OuterBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
              <!-- Change border color on IsKeyboardFocused (click/tab focus) -->
              <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter TargetName="OuterBorder" Property="BorderBrush" Value="#0078D7" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- ScrollBar Templates -->
    <ControlTemplate x:Key="VerticalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
      <Grid x:Name="GridRoot" Width="{TemplateBinding Width}" Background="{TemplateBinding Background}">
        <Grid.RowDefinitions>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Track x:Name="PART_Track" Grid.Row="0"
                       IsDirectionReversed="true"
                       Focusable="false">
          <Track.Thumb>
            <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Width="{TemplateBinding Width}">
              <Thumb.Template>
                <ControlTemplate TargetType="{x:Type Thumb}">
                  <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            CornerRadius="5"
                                            Margin="1,0,1,0"/>
                </ControlTemplate>
              </Thumb.Template>
            </Thumb>
          </Track.Thumb>
        </Track>
      </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="HorizontalScrollBarTemplate" TargetType="{x:Type ScrollBar}">
      <Grid x:Name="GridRoot" Height="{TemplateBinding Height}" Background="{TemplateBinding Background}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Track x:Name="PART_Track" Grid.Column="0"
                       IsDirectionReversed="false"
                       Focusable="false">
          <Track.Thumb>
            <Thumb Background="#FF99AAB5" BorderBrush="#FF99AAB5" Height="{TemplateBinding Height}">
              <Thumb.Template>
                <ControlTemplate TargetType="{x:Type Thumb}">
                  <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            CornerRadius="5"
                                            Margin="0,1,0,1"/>
                </ControlTemplate>
              </Thumb.Template>
            </Thumb>
          </Track.Thumb>
        </Track>
      </Grid>
    </ControlTemplate>

    <!-- Implicit Style for ScrollBar, applying templates based on Orientation -->
    <Style TargetType="{x:Type ScrollBar}">
      <Setter Property="Background" Value="Transparent"/>
      <!-- Default track background -->
      <Style.Triggers>
        <Trigger Property="Orientation" Value="Vertical">
          <Setter Property="Template" Value="{StaticResource VerticalScrollBarTemplate}"/>
          <Setter Property="Width" Value="10"/>
          <!-- Set your desired vertical width -->
          <Setter Property="Margin" Value="0,1,0,1"/>
        </Trigger>
        <Trigger Property="Orientation" Value="Horizontal">
          <Setter Property="Template" Value="{StaticResource HorizontalScrollBarTemplate}"/>
          <Setter Property="Height" Value="10"/>
          <!-- Set your desired horizontal height -->
          <Setter Property="Margin" Value="1,0,1,0"/>
        </Trigger>
      </Style.Triggers>
    </Style>

  </Window.Resources>

  <Border Background="White" CornerRadius="0" BorderBrush="Transparent" BorderThickness="1"
            Padding="0" Margin="0">
    <Border.Effect>
      <DropShadowEffect BlurRadius="25" Opacity="0.8" ShadowDepth="8" Direction="270" Color="#000000"/>
    </Border.Effect>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>
      <Border Grid.Row="0" Background="#FF333333" CornerRadius="0"
                    MouseLeftButtonDown="Window_MouseLeftButtonDown" Height="40">
        <Grid>
          <TextBlock Text="Post Announcement"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#fff"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left" Margin="20,0,0,0"/>
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="&#xE8BB;" Style="{StaticResource TitleBarButtonStyle}" Click="CloseButton_Click" Background="#FFC0392B" FontFamily="Segoe MDL2 Assets"/>
          </StackPanel>
        </Grid>
      </Border>

      <!-- Main Content Area -->
      <StackPanel Grid.Row="1" Margin="0,0,0,0">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          <Grid Grid.Column="0">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <!-- Corrected TextBlock with "New Announcement" -->
              <TextBlock Grid.Row="0" Text="New Announcement" Foreground="#333333" FontSize="16" FontWeight="SemiBold"
                                       Padding="10,8,10,0"/>

              <StackPanel Grid.Row="1" Margin="10,10,10,10">
                <!-- TextBox for announcement content -->
                <TextBox Style="{StaticResource FocusedBorderStyle}" Margin="0,0,0,0" TextWrapping="Wrap"
                                  x:Name="NewAnnouncment" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Height="660">
                  <TextBox.Effect>
                    <DropShadowEffect Color="#FFBBBBBB" Direction="270" ShadowDepth="8" BlurRadius="25" Opacity="0.3" />
                  </TextBox.Effect>
                  <!-- No ControlTemplate here, the ScrollViewer within the TextBox's Style will use the implicit ScrollBar style -->
                </TextBox>
              </StackPanel>
            </Grid>
          </Grid>

          <Grid Grid.Column="1">
            <Grid Margin="10,10,10,0">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>
              <Grid Grid.Row="0">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>

                  <Border Grid.Row="0"  Grid.Column="0">
                    <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Announce">
                      <Image Source="/Images/volume.png" />
                    </Button>
                  </Border>

                  <Border Grid.Row="0"  Grid.Column="1">
                    <ToggleButton x:Name="CheckButton"
                                  Style="{StaticResource ToolBarIconToggleButtonStyle}"
                                  ToolTip="All"
                                  Checked="ToggleButton_Checked"
                                  Unchecked="ToggleButton_Unchecked">
                      <Image Source="/Images/check-mark.png"/>
                    </ToggleButton>
                  </Border>

                  <Border Grid.Row="0"  Grid.Column="2">
                    <ToggleButton x:Name="UncheckButton"
                                  Style="{StaticResource ToolBarIconToggleButtonStyle}"
                                  ToolTip="None"
                                  IsChecked="False"
                                  Checked="ToggleButton_Checked"
                                  Unchecked="ToggleButton_Unchecked">
                      <Image Source="/Images/uncheck.png" />
                    </ToggleButton>
                  </Border>

                  <Border Grid.Row="0"  Grid.Column="3">
                    <ToggleButton x:Name="GroupToggleButton" Style="{StaticResource ToolBarIconButtonStyleCheck}"
                                  Checked="GroupToggleButton_Checked"
                                   ToolTip="Show Groups"
                                  Unchecked="GroupToggleButton_Unchecked">
                      <Image Source="/Images/group.png"/>
                    </ToggleButton>
                  </Border>

                  <Border Grid.Row="0"  Grid.Column="4">
                    <Button Style="{StaticResource ToolBarIconButtonStyle}" ToolTip="Browse Image">
                      <Image Source="/Images/uploadimg.png" />
                    </Button>
                  </Border>
                </Grid>
              </Grid>

              <!-- The ScrollViewer for the ListBoxes -->
              <ScrollViewer Background="#fff"  Grid.Row="1"
                            Margin="10,10,0,20"
                            VerticalScrollBarVisibility="Auto"
                            HorizontalScrollBarVisibility="Auto"
                            Height="605">
                <ScrollViewer.Effect>
                  <DropShadowEffect Color="#FFBBBBBB" Direction="270" ShadowDepth="8" BlurRadius="25" Opacity="0.3" />
                </ScrollViewer.Effect>
                <!-- The implicit ScrollBar style defined in Window.Resources will be used here -->

                <StackPanel>
                  <ListBox x:Name="Announcment" Style="{DynamicResource ModernListBoxStyle}" Width="320"
                          ItemContainerStyle="{DynamicResource ModernListBoxItemStyle}"
                          HorizontalAlignment="Left">
                    <ListBoxItem Content="Ahmad Al-Khalil" />
                    <ListBoxItem Content="Omar Al-Saadi" />
                    <ListBoxItem Content="Sara Al-Mutairi" />
                    <ListBoxItem Content="Hassan Al-Farouq" />
                    <ListBoxItem Content="Layla Al-Rashid" />
                    <ListBoxItem Content="Yousef Al-Hassan" />
                    <ListBoxItem Content="Mariam Al-Amin" />
                    <ListBoxItem Content="Kareem Al-Zahra" />
                    <ListBoxItem Content="Aisha Al-Hamdan" />
                    <ListBoxItem Content="Tariq Al-Fayez" />
                    <ListBoxItem Content="Ahmad Al-Khalil" />
                    <ListBoxItem Content="Omar Al-Saadi" />
                    <ListBoxItem Content="Sara Al-Mutairi" />
                    <ListBoxItem Content="Hassan Al-Farouq" />
                    <ListBoxItem Content="Layla Al-Rashid" />
                    <ListBoxItem Content="Yousef Al-Hassan" />
                    <ListBoxItem Content="Mariam Al-Amin" />
                    <ListBoxItem Content="Kareem Al-Zahra" />
                    <ListBoxItem Content="Aisha Al-Hamdan" />
                    <ListBoxItem Content="Tariq Al-Fayez" />
                    <ListBoxItem Content="Ahmad Al-Khalil" />
                    <ListBoxItem Content="Omar Al-Saadi" />
                    <ListBoxItem Content="Sara Al-Mutairi" />
                    <ListBoxItem Content="Hassan Al-Farouq" />
                    <ListBoxItem Content="Layla Al-Rashid" />
                    <ListBoxItem Content="Yousef Al-Hassan" />
                    <ListBoxItem Content="Mariam Al-Amin" />
                    <ListBoxItem Content="Kareem Al-Zahra" />
                    <ListBoxItem Content="Aisha Al-Hamdan" />
                    <ListBoxItem Content="Tariq Al-Fayez" />
                  </ListBox>

                  <ListBox x:Name="GroupsAnnouncment" Style="{DynamicResource ModernListBoxStyle}" Width="320" Visibility="Collapsed"
                          ItemContainerStyle="{DynamicResource ModernListBoxItemSecondStyle}"
                          HorizontalAlignment="Left">
                    <ListBoxItem Content="Ahmad Al-Khalil" />
                    <ListBoxItem Content="Omar Al-Saadi" />
                    <ListBoxItem Content="Sara Al-Mutairi" />
                    <ListBoxItem Content="Hassan Al-Farouq" />
                    <ListBoxItem Content="Layla Al-Rashid" />
                    <ListBoxItem Content="Yousef Al-Hassan" />
                    <ListBoxItem Content="Mariam Al-Amin" />
                  </ListBox>
                </StackPanel>
              </ScrollViewer>
            </Grid>
          </Grid>
        </Grid>
      </StackPanel>
    </Grid>
  </Border>
</Window>